


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="bp.html">
      
      
        <link rel="next" href="simon.html">
      
      
      <link rel="icon" href="../../_static/favicon.svg">
    
    
      
        <title>Training quantum process transformation with PQC - QuAIRKit</title>
      
    
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../../_static/sphinx_immaterial_theme.6ec1c446c2c357833.min.css?v=e2e8fea8" />
        <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="QuAIRKit" class="md-header__button md-logo" aria-label="QuAIRKit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QuAIRKit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Training quantum process transformation with PQC
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/QuAIR/QuAIRKit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    QuAIRKit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="QuAIRKit" class="md-nav__button md-logo" aria-label="QuAIRKit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>
    </a>
    QuAIRKit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/QuAIR/QuAIRKit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    QuAIRKit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quairkit.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/quairkit.rst (reference label)"><span>quairkit</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/tutorials.rst (reference label)"><span>tutorials</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            <span title="/tutorials.rst (reference label)"><span>tutorials</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials.feature.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials.feature.rst (reference label)"><span>tutorials.<wbr>feature</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials.introduction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials.introduction.rst (reference label)"><span>tutorials.<wbr>introduction</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials.research.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/tutorials.research.rst (reference label)"><span>tutorials.<wbr>research</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            <span title="/tutorials.research.rst (reference label)"><span>tutorials.<wbr>research</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="bp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/research/bp.ipynb (reference label)"><span>Analyze Barren Plateau in Quantum Neural Networks</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/research/comb.ipynb (reference label)"><span>Training quantum process transformation with PQC</span></span>
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/research/comb.ipynb (reference label)"><span>Training quantum process transformation with PQC</span></span>
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Introduction" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#introduction (reference label)"><span>Introduction</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Background" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#background (reference label)"><span>Background</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Construct-a-PQC-to-train-process-transformation-from-scratch" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#construct-a-pqc-to-train-process-transformation-from-scratch (reference label)"><span>Construct a PQC to train process transformation from scratch</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Construct a PQC to train process transformation from scratch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Construct-the-quantum-circuit" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#construct-the-quantum-circuit (reference label)"><span>Construct the quantum circuit</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Loss-function" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#loss-function (reference label)"><span>Loss function</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Train-the-circuit" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#train-the-circuit (reference label)"><span>Train the circuit</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Parameterized-Quantum-CombNet---a-ML-tool-for-quantum-process-transformation-training" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#parameterized-quantum-combnet---a-ml-tool-for-quantum-process-transformation-training (reference label)"><span>Parameterized Quantum Comb<wbr>Net -<wbr> a ML tool for quantum process transformation training</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parameterized Quantum CombNet - a ML tool for quantum process transformation training">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#What-is-quantum-comb" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#what-is-quantum-comb (reference label)"><span>What is quantum comb</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Construct-quantum-comb-with-PQC" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#construct-quantum-comb-with-pqc (reference label)"><span>Construct quantum comb with PQC</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Initializing-PQCombNet" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#initializing-pqcombnet (reference label)"><span>Initializing PQComb<wbr>Net</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Other-functional" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#other-functional (reference label)"><span>Other functional</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#References" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#references (reference label)"><span>References</span></span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="simon.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/research/simon.ipynb (reference label)"><span>Rediscovering Simon’s algorithm with PQC</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="trotter.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/research/trotter.ipynb (reference label)"><span>Hamiltonian simulation via Trotter decomposition</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Introduction" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#introduction (reference label)"><span>Introduction</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Background" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#background (reference label)"><span>Background</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Construct-a-PQC-to-train-process-transformation-from-scratch" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#construct-a-pqc-to-train-process-transformation-from-scratch (reference label)"><span>Construct a PQC to train process transformation from scratch</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Construct a PQC to train process transformation from scratch">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Construct-the-quantum-circuit" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#construct-the-quantum-circuit (reference label)"><span>Construct the quantum circuit</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Loss-function" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#loss-function (reference label)"><span>Loss function</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Train-the-circuit" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#train-the-circuit (reference label)"><span>Train the circuit</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Parameterized-Quantum-CombNet---a-ML-tool-for-quantum-process-transformation-training" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#parameterized-quantum-combnet---a-ml-tool-for-quantum-process-transformation-training (reference label)"><span>Parameterized Quantum Comb<wbr>Net -<wbr> a ML tool for quantum process transformation training</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Parameterized Quantum CombNet - a ML tool for quantum process transformation training">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#What-is-quantum-comb" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#what-is-quantum-comb (reference label)"><span>What is quantum comb</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Construct-quantum-comb-with-PQC" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#construct-quantum-comb-with-pqc (reference label)"><span>Construct quantum comb with PQC</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Initializing-PQCombNet" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#initializing-pqcombnet (reference label)"><span>Initializing PQComb<wbr>Net</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Other-functional" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#other-functional (reference label)"><span>Other functional</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#References" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/research/comb.ipynb#references (reference label)"><span>References</span></span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
                  


<h1 id="Training-quantum-process-transformation-with-PQC">Training quantum process transformation with PQC<a class="headerlink" href="#Training-quantum-process-transformation-with-PQC" title="Link to this heading">¶</a></h1>
<p><strong>Table of Contents</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#Introduction"><span class="std std-ref">Introduction</span></a></p></li>
<li><p><a class="reference internal" href="#Background"><span class="std std-ref">Background</span></a></p></li>
<li><p><a class="reference internal" href="#Construct-a-PQC-to-train-process-transformation-from-scratch"><span class="std std-ref">Construct from Scratch</span></a></p>
<ul>
<li><p><a class="reference internal" href="#Construct-the-quantum-circuit"><span class="std std-ref">Construct the quantum circuit</span></a></p></li>
<li><p><a class="reference internal" href="#Loss-function"><span class="std std-ref">Loss function</span></a></p></li>
<li><p>Training the PQC</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#Parameterized-Quantum-CombNet---a-ML-tool-for-quantum-process-transformation-training"><span class="std std-ref">PQCombNet</span></a></p>
<ul>
<li><p><a class="reference internal" href="#What-is-quantum-comb"><span class="std std-ref">What is quantum comb</span></a></p></li>
<li><p><a class="reference internal" href="#Construct-quantum-comb-with-PQC"><span class="std std-ref">Construct quantum comb with PQC</span></a></p></li>
<li><p><a class="reference internal" href="#Initializing-PQCombNet"><span class="std std-ref">Initialize PQCombNet</span></a></p></li>
<li><p><a class="reference internal" href="#Other-functional"><span class="std std-ref">Other functional</span></a></p></li>
</ul>
</li>
</ul>
<h2 id="Introduction">Introduction<a class="headerlink" href="#Introduction" title="Link to this heading">¶</a></h2>
<p>Quantum processes represent the fundamental transformations that govern the evolution of quantum states, enabling the manipulation, communication, and computation of quantum information. Understanding and simulating quantum processes and their transformations is critical for advancing research in these fields.</p>
<p>A common approach to simulate a quantum process transformation is by using a parameterized quantum circuit (PQC), which provides a flexible framework for encoding and optimizing quantum operations. In this tutorial, we will introduce two approaches for constructing and training quantum processes using PQCs:</p>
<ol class="arabic simple">
<li><p>Constructing a PQC from Scratch<strong>:</strong> This method involves building a parameterized quantum process from the ground up using our QuAIRKit’s capabilities, offering fine-grained control over the circuit structure and parameters.</p></li>
<li><p>Simulating Process with Our QuAIR Toolkit - PQCombNet<strong>:</strong> The PQCombNet tool, as a part of the QuAIRKit application, streamlines the initialization of quantum combs [1], enabling a more efficient and intuitive simulation of quantum process transformations.</p></li>
</ol>
<p>These approaches provide versatile pathways for exploring and optimizing quantum processes, tailored to the needs of researchers and practitioners in quantum information science.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch</span>


<span class="kn">import</span> <span class="nn">quairkit</span> <span class="k">as</span> <span class="nn">qkit</span>
<span class="kn">from</span> <span class="nn">quairkit</span> <span class="kn">import</span> <span class="n">Circuit</span>
<span class="kn">from</span> <span class="nn">quairkit.database</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">quairkit.qinfo</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">qkit</span><span class="o">.</span><span class="n">set_device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>  <span class="c1"># alternatively, switch to &quot;cuda:x&quot; for GPU</span>
<span class="n">qkit</span><span class="o">.</span><span class="n">set_dtype</span><span class="p">(</span><span class="s2">&quot;complex128&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<h2 id="Background">Background<a class="headerlink" href="#Background" title="Link to this heading">¶</a></h2>
<p>The time evolution of a closed quantum system is governed by a unitary operator $ U = e^{-iHt} $, where $ H $ represents the Hamiltonian of the system and $ t $ denotes time. The inverse of this transformation is given by $ U^{-1} = e^{iHt} $. This reversible nature of quantum operations distinguishes quantum processes from classical ones, highlighting a key feature of quantum mechanics.</p>
<p>Reversing a quantum process by obtaining its time-reversed unitary $ U^{-1} $ is a fundamental task in quantum information science. However, deriving the inverse operation for an unknown unitary is challenging and resource-intensive. The conventional approach, known as quantum process tomography, requires a prohibitively large number of measurements to fully reconstruct the Hamiltonian $ H $ and, consequently, the entire quantum process for reversal. Alternatively, it is possible to approximate
$ U^{-1} $ directly using the original unitary $ U $ without performing process tomography.</p>
<p>In this tutorial, two approaches to simulate the inverse of an unknown unitary by constructing parameterized quantum circuits (PQC) will be presented.</p>
<h2 id="Construct-a-PQC-to-train-process-transformation-from-scratch">Construct a PQC to train process transformation from scratch<a class="headerlink" href="#Construct-a-PQC-to-train-process-transformation-from-scratch" title="Link to this heading">¶</a></h2>
<p>The objective of our quantum circuits is to perform the inverse operation <span class="math notranslate nohighlight">\(U^{-1}\)</span> of a given unitary <span class="math notranslate nohighlight">\(U\)</span>. In particular, this circuit should query a finite number of <span class="math notranslate nohighlight">\(U\)</span> copies and output <span class="math notranslate nohighlight">\(f(U)\ket{\psi}\)</span> for any input state <span class="math notranslate nohighlight">\(\ket{\psi}\)</span>, where <span class="math notranslate nohighlight">\(f(U) = U^{-1} = U^\dagger\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># the target quantum process we want to simulate</span>
<span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="n">dagger</span>
</code></pre></div>
</div>
</div>
<p>In the rest of this tutorial, one will focus on the task of qubit-unitary inversion. The number of unitaries used in the circuit is named <code class="docutils literal notranslate"><span class="pre">num_slots</span></code>, and the number of ancilla qubits utilized in the circuit is denoted as <code class="docutils literal notranslate"><span class="pre">num_aux_qubits</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">num_slots</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">num_aux_qubits</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">ancilla_systems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_aux_qubits</span><span class="p">))</span>
<span class="n">all_systems</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_aux_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<p>We also need to prepare the training set of PQC - a set of sampled unitary from the Haar measure in the 2-dimensional unitary group.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">num_sample</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">train_set</span> <span class="o">=</span> <span class="n">random_unitary</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_sample</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<h3 id="Construct-the-quantum-circuit">Construct the quantum circuit<a class="headerlink" href="#Construct-the-quantum-circuit" title="Link to this heading">¶</a></h3>
<p>In our example, we initialize <code class="docutils literal notranslate"><span class="pre">num_slots</span> <span class="pre">+</span> <span class="pre">1</span></code> parameterized universal qudit gates, as we want to insert the target unitary <span class="math notranslate nohighlight">\(U\)</span> between each pair of parameterized structures. Each of these gates requires <span class="math notranslate nohighlight">\(d^2 - 1\)</span> parameters, where <span class="math notranslate nohighlight">\(d\)</span> is the dimension of the qudit gate. The complete circuit construction is illustrated as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">cir</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="n">num_aux_qubits</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">cir</span><span class="o">.</span><span class="n">universal_qudits</span><span class="p">(</span><span class="n">all_systems</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_slots</span><span class="p">):</span>
    <span class="n">cir</span><span class="o">.</span><span class="n">oracle</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> <span class="p">[</span><span class="n">num_aux_qubits</span><span class="p">],</span> <span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;U_\textrm</span><span class="si">{in}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># input batch unitary</span>
    <span class="n">cir</span><span class="o">.</span><span class="n">universal_qudits</span><span class="p">(</span><span class="n">all_systems</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p>How can we ensure that the trained circuit reliably processes any input state? A common approach is to “borrow” an additional qubit system that is initialized in one part of the Bell state. In this setup, the output of the optimal circuit will ideally be the Choi state corresponding to the target function <span class="math notranslate nohighlight">\(f\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">input_state</span> <span class="o">=</span> <span class="n">nkron</span><span class="p">(</span><span class="n">zero_state</span><span class="p">(</span><span class="n">num_aux_qubits</span><span class="p">),</span> <span class="n">bell_state</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">expect_state</span> <span class="o">=</span> <span class="n">bell_state</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">train_set</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<h3 id="Loss-function">Loss function<a class="headerlink" href="#Loss-function" title="Link to this heading">¶</a></h3>
<p>The loss function is chosen to be the average trace distance between the output state <span class="math notranslate nohighlight">\(\rho_{\text{out}}(U)\)</span> and the expected state <span class="math notranslate nohighlight">\(\rho_{\text{exp}}(U)\)</span> for all sampled unitaries <span class="math notranslate nohighlight">\(U\)</span>. Specifically:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\rho_{\text{out}}(U)\)</span> is the output state from our circuit, when <span class="math notranslate nohighlight">\(U\)</span> is the input unitary.</p></li>
<li><p><span class="math notranslate nohighlight">\(\rho_{\text{exp}}(U)\)</span> is the expected output state, expected to be <span class="math notranslate nohighlight">\(\frac{1}{2}\sum_{i, j=0}^1 f(U) \ket{i}\bra{j} f(U)^\dagger \otimes \ket{i}\bra{j}\)</span>.</p></li>
</ul>
<p>The trace distance is defined as:</p>
<div class="math notranslate nohighlight">
\[D(\rho, \sigma) = \frac{1}{2}\operatorname{tr}\left|\rho - \sigma\right|,
\tag{1}\]</div>
<p>where <span class="math notranslate nohighlight">\(|A|\)</span> represents the positive semidefinite square root of <span class="math notranslate nohighlight">\(A^\dagger A\)</span>. Then the loss function is mathematically represented as</p>
<div class="math notranslate nohighlight">
\[\mathcal{L} = \frac{1}{\text{\# of } U} \sum_{U} D(\rho_{\text{out}}(U), \rho_{\text{exp}}(U)).
\tag{2}\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">loss_func</span><span class="p">(</span><span class="n">circuit</span><span class="p">:</span> <span class="n">Circuit</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Compute the loss function according to Equation (2)</span>

<span class="sd">    Args:</span>
<span class="sd">        circuit: the quantum circuit to be trained</span>

<span class="sd">    Returns:</span>
<span class="sd">        the average trace distance between the output state and the expect state</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">output_state</span> <span class="o">=</span> <span class="n">circuit</span><span class="p">(</span><span class="n">input_state</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">ancilla_systems</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">trace_distance</span><span class="p">(</span><span class="n">output_state</span><span class="p">,</span> <span class="n">expect_state</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<p>One also needs to setup a fidelity function to test the generality of our trained circuit. To do this, one could use another batch of random unitaries to construct a new batched circuit. Such circuit is passed through a random input state, to see the state fidelity between the output states of the trained circuit with the expected output states. Note that for test case, there is no need to add an extra line.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">test_set</span> <span class="o">=</span> <span class="n">random_unitary</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_sample</span><span class="p">)</span>
<span class="n">test_state</span> <span class="o">=</span> <span class="n">random_state</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">test_input_state</span> <span class="o">=</span> <span class="n">nkron</span><span class="p">(</span><span class="n">zero_state</span><span class="p">(</span><span class="n">num_aux_qubits</span><span class="p">),</span> <span class="n">test_state</span><span class="p">)</span>
<span class="n">test_expect_state</span> <span class="o">=</span> <span class="n">test_state</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">test_set</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">fidelity_func</span><span class="p">(</span><span class="n">circuit</span><span class="p">:</span> <span class="n">Circuit</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Compute the fidelity between the output state and the expect state</span>

<span class="sd">    Args:</span>
<span class="sd">        circuit: the quantum circuit to be trained</span>

<span class="sd">    Returns:</span>
<span class="sd">        the average fidelity between the output state and the expect state</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">test_cir</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="n">num_aux_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">test_cir</span><span class="o">.</span><span class="n">universal_qudits</span><span class="p">(</span><span class="n">all_systems</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_slots</span><span class="p">):</span>
        <span class="n">test_cir</span><span class="o">.</span><span class="n">oracle</span><span class="p">(</span><span class="n">test_set</span><span class="p">,</span> <span class="p">[</span><span class="n">num_aux_qubits</span><span class="p">])</span>
        <span class="n">test_cir</span><span class="o">.</span><span class="n">universal_qudits</span><span class="p">(</span><span class="n">all_systems</span><span class="p">)</span>
    <span class="n">test_cir</span><span class="o">.</span><span class="n">update_param</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">param</span><span class="p">)</span>

    <span class="n">output_state</span> <span class="o">=</span> <span class="n">test_cir</span><span class="p">(</span><span class="n">test_input_state</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">ancilla_systems</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">state_fidelity</span><span class="p">(</span><span class="n">output_state</span><span class="p">,</span> <span class="n">test_expect_state</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<h3 id="Train-the-circuit">Train the circuit<a class="headerlink" href="#Train-the-circuit" title="Link to this heading">¶</a></h3>
<p>After setting up learning rate and total number of iterations, we are now ready to train the circuit with our predefined loss function <span class="math notranslate nohighlight">\(\mathcal{L}\)</span> to simulate the process transformation <span class="math notranslate nohighlight">\(f(U) = U^{-1}\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">lr</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">num_iter</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">cir</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>
<span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">lr_scheduler</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">opt</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">time_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">itr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_iter</span><span class="p">):</span>
    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_func</span><span class="p">(</span><span class="n">cir</span><span class="p">)</span> <span class="c1"># compute loss</span>

    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="n">scheduler</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span> <span class="c1"># activate scheduler</span>

    <span class="n">time_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">itr</span> <span class="o">%</span> <span class="p">(</span><span class="n">num_iter</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">itr</span> <span class="o">==</span> <span class="n">num_iter</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">fidelity</span> <span class="o">=</span> <span class="n">fidelity_func</span><span class="p">(</span><span class="n">cir</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;iter: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">itr</span><span class="p">)</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">num_iter</span><span class="p">)))</span><span class="si">}</span><span class="s2">, &quot;</span> <span class="o">+</span>
              <span class="sa">f</span><span class="s2">&quot;loss: </span><span class="si">{</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">, fidelity: </span><span class="si">{</span><span class="n">fidelity</span><span class="si">:</span><span class="s2">.8f</span><span class="si">}</span><span class="s2">, &quot;</span> <span class="o">+</span>
              <span class="sa">f</span><span class="s2">&quot;lr: </span><span class="si">{</span><span class="n">scheduler</span><span class="o">.</span><span class="n">get_last_lr</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2E</span><span class="si">}</span><span class="s2">, avg_time: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">time_list</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
        <span class="n">time_list</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
iter: 0000, loss: 0.78368684, fidelity: 0.74825881, lr: 5.00E-02, avg_time: 0.0767s
iter: 0200, loss: 0.07118932, fidelity: 0.97523268, lr: 2.50E-02, avg_time: 0.0437s
iter: 0400, loss: 0.05067148, fidelity: 0.98335111, lr: 1.25E-02, avg_time: 0.0434s
iter: 0600, loss: 0.03931480, fidelity: 0.98649605, lr: 6.25E-03, avg_time: 0.0408s
iter: 0800, loss: 0.03309163, fidelity: 0.98880576, lr: 3.13E-03, avg_time: 0.0374s
iter: 1000, loss: 0.02946343, fidelity: 0.99014120, lr: 3.13E-03, avg_time: 0.0444s
iter: 1200, loss: 0.02581329, fidelity: 0.99145987, lr: 3.13E-03, avg_time: 0.0386s
iter: 1400, loss: 0.02415567, fidelity: 0.99204658, lr: 7.81E-04, avg_time: 0.0377s
iter: 1600, loss: 0.02323923, fidelity: 0.99237217, lr: 7.81E-04, avg_time: 0.0383s
iter: 1800, loss: 0.02224896, fidelity: 0.99272043, lr: 7.81E-04, avg_time: 0.0383s
iter: 1999, loss: 0.02119630, fidelity: 0.99308737, lr: 7.81E-04, avg_time: 0.0403s
</pre></div></div>
</div>
<p>As shown by above training result, one can obtain a trained circuit that can effectively simulate the inverse of a given unitary <span class="math notranslate nohighlight">\(U\)</span>, with test fidelity above 99%.</p>
<h2 id="Parameterized-Quantum-CombNet---a-ML-tool-for-quantum-process-transformation-training">Parameterized Quantum CombNet - a ML tool for quantum process transformation training<a class="headerlink" href="#Parameterized-Quantum-CombNet---a-ML-tool-for-quantum-process-transformation-training" title="Link to this heading">¶</a></h2>
<p>Apparently above construction is far more complicated for beginners in quantum information science. To simplify the code work, we have developed a class named <code class="docutils literal notranslate"><span class="pre">PQCombNet</span></code> to streamline above process, and bring more functionalities to the table. To be specific, PQCombNet abstracts above idea into quantum comb, and provides a more intuitive way to train the quantum process transformation.</p>
<h3 id="What-is-quantum-comb">What is quantum comb<a class="headerlink" href="#What-is-quantum-comb" title="Link to this heading">¶</a></h3>
<p>A quantum comb [2] can be thought of as a series of quantum operations or gates that act sequentially or in parallel on quantum states. It is a tool to represent quantum channels, processes, or transformations that involve multiple quantum gates, typically applied to a series of quantum bits (qubits).</p>
<p>Here is a simple visualization of a quantum (sequential) comb:</p>
<figure style="text-align: center;"><p><img alt="alt text" class="no-scaled-link" src="tutorials/research/figures/Qcomb.png" style="width: 1000px;" /></p>
<figcaption><p>Fig.1: The schematic representation of sequential quantum comb structure.</p>
</figcaption></figure><p><strong>P</strong> and <strong>F</strong> denote the input and output systems of the main register. <span class="math notranslate nohighlight">\(I_k\)</span> and <span class="math notranslate nohighlight">\(O_k\)</span> correspond to the input and output systems for the operation in the k-th slot. Additionally, <span class="math notranslate nohighlight">\(\mathcal{N}_\textrm{in}^{(k)}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{N}_\textrm{out}\)</span> denote the <span class="math notranslate nohighlight">\(k\)</span>-th input operation and the final output operation highlighted by red boxes, respectively. Each tooth within the comb, corresponding to the <span class="math notranslate nohighlight">\(k\)</span>-th position, is characterized by a quantum channel
<span class="math notranslate nohighlight">\(\mathcal{V}_k\)</span>. Here <span class="math notranslate nohighlight">\(\textrm{aux}_k\)</span> denotes the ancilla system shared by <span class="math notranslate nohighlight">\(\mathcal{V}_{k-1}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{V}_k\)</span>. At the end of the circuit, the projector <span class="math notranslate nohighlight">\(\Pi\)</span> determines the post-selection of the output auxiliary system. Usually, <span class="math notranslate nohighlight">\(\Pi\)</span> could be selected as the identity matrix, i.e., the output auxiliary system is traced out.</p>
<h3 id="Construct-quantum-comb-with-PQC">Construct quantum comb with PQC<a class="headerlink" href="#Construct-quantum-comb-with-PQC" title="Link to this heading">¶</a></h3>
<p>To enhance the flexibility and adaptability of quantum combs, we utilize PQC to construct a <code class="docutils literal notranslate"><span class="pre">Parameterized</span> <span class="pre">Quantum</span> <span class="pre">Comb</span> <span class="pre">(PQcomb)</span></code>. For the target process transformation <span class="math notranslate nohighlight">\(f\)</span>, that take process <span class="math notranslate nohighlight">\(\mathcal{N}_\textrm{in}^{(1)}, \ldots, \mathcal{N}_\textrm{in}^{(m)}\)</span> as inputs and <span class="math notranslate nohighlight">\(\mathcal{N}_\textrm{out}\)</span> as an ouput, such that:</p>
<div class="math notranslate nohighlight">
\[f(\mathcal{N}_\textrm{in}^{(1)}, \ldots, \mathcal{N}_\textrm{in}^{(m)}) = \mathcal{N}_\textrm{out},
\tag{3}\]</div>
<p>the PQC approach to realize such transforamtion is to replace the data processing channel by PQC parameterized by <span class="math notranslate nohighlight">\(\theta\)</span>. One choice of the loss function is the dissimilarity between the trained process <span class="math notranslate nohighlight">\(\widehat{\mathcal{N}}_\textrm{out}\)</span> and expected process <span class="math notranslate nohighlight">\(\mathcal{N}_\textrm{out}\)</span>. Optimizing this loss function will provide us with a practical solution to achieve the desired transformation. In our previous example, such dissimilarity is measured by the trace distance
(Equation (1)) between Choi states of <span class="math notranslate nohighlight">\(\widehat{\mathcal{N}}_\textrm{out}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{N}_\textrm{out}\)</span>.</p>
<h3 id="Initializing-PQCombNet">Initializing PQCombNet<a class="headerlink" href="#Initializing-PQCombNet" title="Link to this heading">¶</a></h3>
<p>First of all, import the necessary libraries for initializing the <code class="docutils literal notranslate"><span class="pre">PQCombNet</span></code> class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">quairkit.application</span> <span class="kn">import</span> <span class="n">PQCombNet</span>
</code></pre></div>
</div>
</div>
<p>Initializing the PQCombNet, we want to achieve the process <span class="math notranslate nohighlight">\(U^{-1}\)</span></p>
<p>According to the recent paper [1], the minimum resource for PQComb to implement the inverse unitary task is 4 <code class="docutils literal notranslate"><span class="pre">num_slots</span></code> and 3 <code class="docutils literal notranslate"><span class="pre">num_aux_qubits</span></code></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">net</span> <span class="o">=</span> <span class="n">PQCombNet</span><span class="p">(</span>
    <span class="n">target_function</span><span class="o">=</span><span class="n">dagger</span><span class="p">,</span>  <span class="c1"># Callable function, no default value</span>
    <span class="n">num_slots</span><span class="o">=</span><span class="n">num_slots</span><span class="p">,</span>  <span class="c1"># Number of slots, no default value</span>
    <span class="n">ancilla</span><span class="o">=</span><span class="n">num_aux_qubits</span><span class="p">,</span>  <span class="c1"># Number of ancilla qubits, no default value</span>
    <span class="n">train_unitary_info</span><span class="o">=</span><span class="n">num_sample</span><span class="p">,</span>  <span class="c1"># Default: 2000 (can be an integer or torch.Tensor for training data)</span>
    <span class="n">test_unitary_info</span><span class="o">=</span><span class="n">num_sample</span><span class="p">,</span>  <span class="c1"># Default: 10000 (can be an integer or torch.Tensor for test data)</span>
    <span class="n">train_mode</span><span class="o">=</span><span class="s2">&quot;process&quot;</span><span class="p">,</span>  <span class="c1"># Default: &quot;process&quot; (alternatively &quot;pqc&quot;, which is gpu friendly)</span>
    <span class="n">seed</span><span class="o">=</span><span class="mi">73</span><span class="p">,</span>  <span class="c1"># Default: None (fix seed for reproducibility)</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<p>This initializes a PQCombNet instance with the specified parameters, ready for training and optimization. Now we can train our model to approximate the quantum process transformation <span class="math notranslate nohighlight">\(f(U) = U^{-1}\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">net</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">base_lr</span><span class="o">=</span><span class="n">lr</span><span class="p">,</span> <span class="n">max_epochs</span><span class="o">=</span><span class="n">num_iter</span><span class="p">,</span> <span class="n">is_save_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">0   0.0470s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-02</span>, <span class="ansi-red-intense-fg">Loss: 0.75544445</span>, <span class="ansi-green-intense-fg">Fid: 0.24738995</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">100 0.0357s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-02</span>, <span class="ansi-red-intense-fg">Loss: 0.07435474</span>, <span class="ansi-green-intense-fg">Fid: 0.92318247</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">200 0.0372s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-02</span>, <span class="ansi-red-intense-fg">Loss: 0.02269175</span>, <span class="ansi-green-intense-fg">Fid: 0.97640096</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">300 0.0365s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-02</span>, <span class="ansi-red-intense-fg">Loss: 0.00940645</span>, <span class="ansi-green-intense-fg">Fid: 0.99023750</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">400 0.0390s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00524944</span>, <span class="ansi-green-intense-fg">Fid: 0.99456681</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">500 0.0376s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00479748</span>, <span class="ansi-green-intense-fg">Fid: 0.99503472</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">600 0.0368s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00434063</span>, <span class="ansi-green-intense-fg">Fid: 0.99550775</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">700 0.0379s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00388731</span>, <span class="ansi-green-intense-fg">Fid: 0.99597701</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">800 0.0379s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00344942</span>, <span class="ansi-green-intense-fg">Fid: 0.99643043</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">900 0.0385s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00303639</span>, <span class="ansi-green-intense-fg">Fid: 0.99685843</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">1000        0.0342s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00265500</span>, <span class="ansi-green-intense-fg">Fid: 0.99725405</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">1100        0.0346s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00230938</span>, <span class="ansi-green-intense-fg">Fid: 0.99761295</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">1200        0.0361s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00200110</span>, <span class="ansi-green-intense-fg">Fid: 0.99793336</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">1300        0.0369s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00172959</span>, <span class="ansi-green-intense-fg">Fid: 0.99821568</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">1400        0.0412s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00149267</span>, <span class="ansi-green-intense-fg">Fid: 0.99846196</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">1500        0.0372s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00128722</span>, <span class="ansi-green-intense-fg">Fid: 0.99867536</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">1600        0.0373s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00110971</span>, <span class="ansi-green-intense-fg">Fid: 0.99885948</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">1700        0.0378s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00095659</span>, <span class="ansi-green-intense-fg">Fid: 0.99901801</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">1800        0.0388s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00082458</span>, <span class="ansi-green-intense-fg">Fid: 0.99915441</span>
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">1900        0.0376s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00071077</span>, <span class="ansi-green-intense-fg">Fid: 0.99927179</span>
Progress |██████████████████████████████████████████████████| 100.0%
[pqcomb_dagger | process | 73 | <span class="ansi-black-intense-fg">1999        0.0368s</span>] slot_dim: 2, slots: 4, ancilla_dim: 8, <span class="ansi-yellow-intense-fg">LR: 5.00e-03</span>, <span class="ansi-red-intense-fg">Loss: 0.00061353</span>, <span class="ansi-green-intense-fg">Fid: 0.99937190</span>
[pqcomb_dagger | process | 73] Finished training with Fidelity: 0.99937284
</pre></div></div>
</div>
<h3 id="Other-functional">Other functional<a class="headerlink" href="#Other-functional" title="Link to this heading">¶</a></h3>
<p>We can have a view of the PQComb by the attribute <code class="docutils literal notranslate"><span class="pre">plot</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">net</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_research_comb_36_0.png" src="../../_images/tutorials_research_comb_36_0.png" />
</div>
</div>
<p>Sometimes we want to test our hypothesis that substituting a certain part of <code class="docutils literal notranslate"><span class="pre">PQCombnet</span></code> with a segment from a random parameterized circuit to a known part can enhance our understanding of quantum architecture or help in searching for an optimized one. The <code class="docutils literal notranslate"><span class="pre">PQCombnet</span></code> provides the method <code class="docutils literal notranslate"><span class="pre">update_V_circuit</span></code>, which allows users to update a specific <code class="docutils literal notranslate"><span class="pre">V</span></code> circuit at a given index within the <code class="docutils literal notranslate"><span class="pre">V_circuit_list</span></code>. The whole quantum process will then be a hybrid circuit combining known structures
with the original parameterized circuit. we will show a simple example in this section about the usage of updating certain part of circuit for a <strong>PQCombNet</strong></p>
<p>For example, we want to substitute a known circuit <code class="docutils literal notranslate"><span class="pre">new_V</span></code> and we can prepare the new_V in several ways.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">quairkit.operator</span> <span class="kn">import</span> <span class="n">ParamOracle</span>

<span class="c1"># Number of qubits in the circuit</span>
<span class="n">num_qubits_cir</span> <span class="o">=</span> <span class="n">num_aux_qubits</span> <span class="o">+</span> <span class="mi">1</span>

<span class="c1"># Circuit</span>
<span class="n">V0</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="n">num_qubits_cir</span><span class="p">)</span>
<span class="n">V0</span><span class="o">.</span><span class="n">real_entangled_layer</span><span class="p">(</span><span class="n">depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="c1"># ParamOracle</span>
<span class="k">def</span> <span class="nf">V_generator</span><span class="p">(</span><span class="n">param</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">rx</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">@</span> <span class="n">u3</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span> <span class="o">@</span> <span class="n">h</span><span class="p">()</span>

<span class="n">V1</span> <span class="o">=</span> <span class="n">ParamOracle</span><span class="p">(</span><span class="n">V_generator</span><span class="p">,</span> <span class="n">system_idx</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_qubits_cir</span><span class="p">)),</span> <span class="n">num_acted_param</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># torch.Tensor as a gate working on all the systems</span>
<span class="n">V2</span> <span class="o">=</span> <span class="n">random_unitary</span><span class="p">(</span><span class="n">num_qubits_cir</span><span class="p">)</span>  <span class="c1"># Work on all the systems</span>

<span class="c1"># torch.Tensor as a gate working on parts of the systems</span>
<span class="n">V3</span> <span class="o">=</span> <span class="n">random_unitary</span><span class="p">(</span><span class="n">num_qubits_cir</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p>Update the V circuit in place at a specified <code class="docutils literal notranslate"><span class="pre">index</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[ ]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># In this example, we replace the `index` 1 (the 2nd part of the PQCombNet) with our prepared structure</span>
<span class="n">net</span><span class="o">.</span><span class="n">update_V_circuit</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">new_V</span><span class="o">=</span><span class="n">V0</span><span class="p">)</span>  <span class="c1"># V1,V2,V3</span>
<span class="c1"># we can visualize the new net after replacement</span>
<span class="n">net</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_research_comb_41_0.png" src="../../_images/tutorials_research_comb_41_0.png" />
</div>
</div>
<ul class="simple">
<li><p><strong>Training Data</strong>: If <code class="docutils literal notranslate"><span class="pre">is_save_data=True</span></code>, the training data will be saved in the directory <code class="docutils literal notranslate"><span class="pre">data_directory_name/V_circuit_lists/</span></code>. Each saved file includes details like the mode used, number of qubits, and fidelity.</p></li>
<li><p><strong>Logs</strong>: Training logs are saved as CSV files named <code class="docutils literal notranslate"><span class="pre">{name_task}_train_log.csv</span></code> in the specified data directory.</p></li>
<li><p><strong>Fidelity Results</strong>: After extracting the highest fidelity, results for each <code class="docutils literal notranslate"><span class="pre">num_qubits_U</span></code> are saved as CSV files with names like <code class="docutils literal notranslate"><span class="pre">fidelity_table_num_qubits_U_{num_qubits_U}.csv</span></code>.</p></li>
</ul>
<hr class="docutils" />
<h2 id="References">References<a class="headerlink" href="#References" title="Link to this heading">¶</a></h2>
<p>[1] Mo, Yin, et al. “Parameterized quantum comb and simpler circuits for reversing unknown qubit-unitary operations.” npj Quantum Information 11.1 (2025): 32.</p>
<p>[2] Chiribella, Giulio, G. Mauro D’Ariano, and Paolo Perinotti. “Quantum circuit architecture.” Physical review letters 101.6 (2008): 060401.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">qkit</span><span class="o">.</span><span class="n">print_info</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

---------VERSION---------
quairkit: 0.4.0
torch: 2.7.0+cpu
numpy: 1.26.0
scipy: 1.14.1
matplotlib: 3.10.0
---------SYSTEM---------
Python version: 3.10.16
OS: Windows
OS version: 10.0.26100
---------DEVICE---------
CPU: ARMv8 (64-bit) Family 8 Model 1 Revision 201, Qualcomm Technologies Inc
</pre></div></div>
</div>
<p><em>Table: A reference of notation conventions in this tutorial.</em></p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(H\)</span></p></td>
<td><p>a Hamiltonian</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(U\)</span></p></td>
<td><p>a unitary transformation</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(f\)</span></p></td>
<td><p>a quantum process transformation</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(D\)</span></p></td>
<td><p>trace distance between two quantum states</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\rho_{\text{out}}(U)\)</span></p></td>
<td><p>output state evolved by the train circuit with input <span class="math notranslate nohighlight">\(U\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\rho_{\text{exp}}(U)\)</span></p></td>
<td><p>expected output state, evolved by the quantum process <span class="math notranslate nohighlight">\(U^{-1}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\mathcal{L}\)</span></p></td>
<td><p>loss function</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\mathcal{N}^{(k)}_\textrm{in}\)</span> and <span class="math notranslate nohighlight">\(\mathcal{N}_\textrm{out}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(k\)</span>-th input operation and the final output operation</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(I_k\)</span> and <span class="math notranslate nohighlight">\(O_k\)</span></p></td>
<td><p>input and output systems for the operation in the <span class="math notranslate nohighlight">\(k\)</span>-th slot</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\Pi\)</span></p></td>
<td><p>an orthogonal projector</p></td>
</tr>
</tbody>
</table>







  
  






                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2024, QuAIR.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    8.1.3.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike", "staticVersions": null, "versionPath": null}}</script>
    
      
        <script src="../../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>
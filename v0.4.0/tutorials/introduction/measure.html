


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="circuit.html">
      
      
        <link rel="next" href="operator.html">
      
      
      <link rel="icon" href="../../_static/favicon.svg">
    
    
      
        <title>Measuring quantum states in QuAIRKit - QuAIRKit</title>
      
    
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../../_static/sphinx_immaterial_theme.918c11dc96aaedbb3.min.css?v=3a27c74e" />
        <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Quantum-measurement" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="QuAIRKit" class="md-header__button md-logo" aria-label="QuAIRKit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QuAIRKit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Measuring quantum states in QuAIRKit
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/QuAIR/QuAIRKit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    QuAIRKit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="QuAIRKit" class="md-nav__button md-logo" aria-label="QuAIRKit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>
    </a>
    QuAIRKit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/QuAIR/QuAIRKit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    QuAIRKit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quairkit.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/quairkit.rst (reference label)">quairkit</span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/tutorials.rst (reference label)">tutorials</span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            <span title="/tutorials.rst (reference label)">tutorials</span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials.feature.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials.feature.rst (reference label)">tutorials.<wbr>feature</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials.introduction.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/tutorials.introduction.rst (reference label)">tutorials.<wbr>introduction</span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            <span title="/tutorials.introduction.rst (reference label)">tutorials.<wbr>introduction</span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="Hamiltonian.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/introduction/hamiltonian.ipynb (reference label)">Hamiltonian in Qu<wbr>AIRKit</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="circuit.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/introduction/circuit.ipynb (reference label)">Constructing quantum circuits in Qu<wbr>AIRKit</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/introduction/measure.ipynb (reference label)">Measuring quantum states in Qu<wbr>AIRKit</span>
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/introduction/measure.ipynb (reference label)">Measuring quantum states in Qu<wbr>AIRKit</span>
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Quantum-measurement" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/introduction/measure.ipynb#quantum-measurement (reference label)">Quantum measurement</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Perform-measurement" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/introduction/measure.ipynb#perform-measurement (reference label)">Perform measurement</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Perform measurement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Positive-operator-valued-measurement" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/introduction/measure.ipynb#positive-operator-valued-measurement (reference label)">Positive operator-<wbr>valued measurement</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Batch-measurement" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/introduction/measure.ipynb#batch-measurement (reference label)">Batch measurement</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Sampled-measurements" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/introduction/measure.ipynb#sampled-measurements (reference label)">Sampled measurements</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#References" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/introduction/measure.ipynb#references (reference label)">References</span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="operator.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/introduction/operator.ipynb (reference label)">Quantum gates and quantum channels</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="qinfo.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/introduction/qinfo.ipynb (reference label)">Quantum information tools</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="state.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/introduction/state.ipynb (reference label)">Manipulation of quantum states in Qu<wbr>AIRKit</span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="training.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/introduction/training.ipynb (reference label)">Training parameterized quantum circuits</span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials.research.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials.research.rst (reference label)">tutorials.<wbr>research</span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Quantum-measurement" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/introduction/measure.ipynb#quantum-measurement (reference label)">Quantum measurement</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Perform-measurement" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/introduction/measure.ipynb#perform-measurement (reference label)">Perform measurement</span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Perform measurement">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Positive-operator-valued-measurement" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/introduction/measure.ipynb#positive-operator-valued-measurement (reference label)">Positive operator-<wbr>valued measurement</span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Batch-measurement" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/introduction/measure.ipynb#batch-measurement (reference label)">Batch measurement</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Sampled-measurements" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/introduction/measure.ipynb#sampled-measurements (reference label)">Sampled measurements</span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#References" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/introduction/measure.ipynb#references (reference label)">References</span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
                  


<h1 id="Measuring-quantum-states-in-QuAIRKit">Measuring quantum states in QuAIRKit<a class="headerlink" href="#Measuring-quantum-states-in-QuAIRKit" title="Link to this heading">¶</a></h1>
<p>This tutorial demonstrates how to perform quantum measurement using QuAIRKit.</p>
<p><strong>Table of Contents</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#Quantum-measurement"><span class="std std-ref">Quantum measurement</span></a></p></li>
<li><p><a class="reference internal" href="#Perform-measurement"><span class="std std-ref">Perform measurement</span></a></p></li>
<li><p><a class="reference internal" href="#Positive-operator-valued-measurement"><span class="std std-ref">Positive operator-valued measurement</span></a></p></li>
<li><p><a class="reference internal" href="#Batch-measurement"><span class="std std-ref">Batch measurement</span></a></p></li>
<li><p><a class="reference internal" href="#Sampled-measurements"><span class="std std-ref">Sampled measurements</span></a></p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[1]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">traceback</span>

<span class="kn">import</span> <span class="nn">quairkit</span> <span class="k">as</span> <span class="nn">qkit</span>
<span class="kn">from</span> <span class="nn">quairkit.database</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">quairkit.loss</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">quairkit.qinfo</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">qkit</span><span class="o">.</span><span class="n">set_dtype</span><span class="p">(</span><span class="s2">&quot;complex128&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<h2 id="Quantum-measurement">Quantum measurement<a class="headerlink" href="#Quantum-measurement" title="Link to this heading">¶</a></h2>
<p>The idea of measurement comes from one of the four postulates in quantum mechanics.</p>
<blockquote>
<div><p>Postulate 3 [1]</p>
<p><em>Quantum measurement</em>s are described by a collection <span class="math notranslate nohighlight">\(\{M_m\}\)</span> of measurement operators. These are operators acting on the state space of the system being measured. The index <span class="math notranslate nohighlight">\(m\)</span> refers to the measurement outcomes that may occur in the experiment. If the state of the quantum system is <span class="math notranslate nohighlight">\(|\psi\rangle\)</span> immediately before the measurement, then the probability that result <span class="math notranslate nohighlight">\(m\)</span> occurs is given by</p>
<div class="math notranslate nohighlight">
\[p(m) = \langle\psi|  M_m^\dagger M_m |\psi\rangle \tag{1}\]</div>
<p>and the state of the system after the measurement is</p>
<div class="math notranslate nohighlight">
\[\frac{M_m |\psi\rangle}{\sqrt{\langle\psi| M_m^\dagger M_m |\psi\rangle}}\tag{2}\]</div>
<p>where the measurement operators satisfy the completeness equation,</p>
<div class="math notranslate nohighlight">
\[\sum_m M_m^\dagger M_m = I.\tag{3}\]</div>
<p>The completeness equation expresses the fact that probabilities sum to one，</p>
<div class="math notranslate nohighlight">
\[\sum_m p(m) = \sum_m \langle \psi \vert M_m^\dagger M_m \vert \psi \rangle= 1\tag{4}\]</div>
</div></blockquote>
<p>Such operator set <span class="math notranslate nohighlight">\(\{M_m\}\)</span> is called a <em>Positive Operator-Valued Measure</em> (POVM). When all <span class="math notranslate nohighlight">\(M_m\)</span> are orthogonal projectors (i.e., <span class="math notranslate nohighlight">\(M_m M_{m'} = \delta_{m,m'}M_m\)</span> and <span class="math notranslate nohighlight">\(M = M^\dagger\)</span>), this set is called a <em>Projection-valued Measure</em> (PVM). The quantum measurement described by PVM is called a <em>projective measurement</em>.</p>
<p>Users can perform projective measurements based on the eigenbasis of an observable. For example, one can generate a PVM for the Pauli matrix <span class="math notranslate nohighlight">\(X\)</span> as an observable. According to the spectral decomposition theorem, the Pauli matrix <span class="math notranslate nohighlight">\(X\)</span> has the decomposition: <span class="math notranslate nohighlight">\(X = \sum_m P_m\)</span>, where the set <span class="math notranslate nohighlight">\(\{P_m\}\)</span> forms a Projection-valued Measure.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">pvm</span> <span class="o">=</span> <span class="n">pauli_str_povm</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Projection-valued measure: </span><span class="se">\n</span><span class="si">{</span><span class="n">pvm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Projection-valued measure:
tensor([[[ 0.5000+0.j,  0.5000+0.j],
         [ 0.5000+0.j,  0.5000+0.j]],

        [[ 0.5000+0.j, -0.5000+0.j],
         [-0.5000+0.j,  0.5000+0.j]]])
</pre></div></div>
</div>
<h2 id="Perform-measurement">Perform measurement<a class="headerlink" href="#Perform-measurement" title="Link to this heading">¶</a></h2>
<p>Projective measurements in QuAIRKit are mainly called by a torch Module <code class="docutils literal notranslate"><span class="pre">Measure</span></code>. There are several ways to initialize a <code class="docutils literal notranslate"><span class="pre">Measure</span></code> instance:</p>
<ol class="arabic simple">
<li><p>Set computational measurement by default, i.e., <span class="math notranslate nohighlight">\(M_m = \{|m\rangle\langle m|\}\)</span></p></li>
<li><p>Set measurement by given Pauli string(s)</p></li>
<li><p>Set measurement by given PVM(s) in <em>torch.Tensor</em></p></li>
</ol>
<p>For <code class="docutils literal notranslate"><span class="pre">Measure</span></code> instances initialized in the first two ways, if the measurement is across all qubits, then the output state(s) will always be recognized as pure state(s).</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">op</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">()</span>  <span class="c1"># computational measure</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>  <span class="c1"># x measure on a qubit</span>
<span class="n">op</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">(</span><span class="n">pvm</span><span class="p">)</span>  <span class="c1"># measure with a pvm</span>
</code></pre></div>
</div>
</div>
<p>Measure accepts the <code class="docutils literal notranslate"><span class="pre">State</span></code> instances and an (optional) measure position as input and returns the measurement result. Note that if the measure only happens on a part of the system, then the argument <code class="docutils literal notranslate"><span class="pre">qubits_idx</span></code> should be specified. The following example is to measure the first subsystem of state <span class="math notranslate nohighlight">\(\rho\)</span> with the PVM defined before.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">op</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">(</span><span class="n">pvm</span><span class="p">)</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">random_state</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">qubits_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># measure rho</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The probability distribution of outcome&quot;</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The probability distribution of outcome tensor([0.5075, 0.4925])
</pre></div></div>
</div>
<p>Users can get the collapsed state by setting <code class="docutils literal notranslate"><span class="pre">keep_state</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">prob</span><span class="p">,</span> <span class="n">collapsed_state</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">qubits_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">keep_state</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The collapsed state for each outcome is&quot;</span><span class="p">,</span> <span class="n">collapsed_state</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The collapsed state for each outcome is
-----------------------------------------------------
 Backend: density_matrix
 System dimension: [2, 2]
 System sequence: [0, 1]
 Batch size: [2]

 # 0:
[[ 0.38+0.j   -0.  -0.03j  0.38+0.j   -0.  -0.03j]
 [-0.  +0.03j  0.12+0.j   -0.  +0.03j  0.12+0.j  ]
 [ 0.38+0.j   -0.  -0.03j  0.38+0.j   -0.  -0.03j]
 [-0.  +0.03j  0.12+0.j   -0.  +0.03j  0.12+0.j  ]]
 # 1:
[[ 0.19+0.j   -0.07+0.08j -0.19+0.j    0.07-0.08j]
 [-0.07-0.08j  0.31+0.j    0.07+0.08j -0.31+0.j  ]
 [-0.19+0.j    0.07-0.08j  0.19+0.j   -0.07+0.08j]
 [ 0.07+0.08j -0.31+0.j   -0.07-0.08j  0.31+0.j  ]]
-----------------------------------------------------

</pre></div></div>
</div>
<p>The probability of particular measurement outcome is obtained via setting <code class="docutils literal notranslate"><span class="pre">desired_result=x</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
<span class="n">prob</span><span class="p">,</span> <span class="n">collapsed_state</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span>
    <span class="n">rho</span><span class="p">,</span> <span class="n">qubits_idx</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">keep_state</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">desired_result</span><span class="o">=</span><span class="n">x</span>
<span class="p">)</span>  <span class="c1"># return the second outcome</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;The probability for obtaining outcome </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2"> is </span><span class="si">{</span><span class="n">prob</span><span class="si">}</span><span class="s2">, with outcome state&quot;</span><span class="p">,</span>
    <span class="n">collapsed_state</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The probability for obtaining outcome 1 is tensor([0.4925]), with outcome state
-----------------------------------------------------
 Backend: density_matrix
 System dimension: [2, 2]
 System sequence: [0, 1]
[[ 0.19+0.j   -0.07+0.08j -0.19+0.j    0.07-0.08j]
 [-0.07-0.08j  0.31+0.j    0.07+0.08j -0.31+0.j  ]
 [-0.19+0.j    0.07-0.08j  0.19+0.j   -0.07+0.08j]
 [ 0.07+0.08j -0.31+0.j   -0.07-0.08j  0.31+0.j  ]]
-----------------------------------------------------

</pre></div></div>
</div>
<p>Users can also directly call the attribute <code class="docutils literal notranslate"><span class="pre">measure</span></code> of <code class="docutils literal notranslate"><span class="pre">State</span></code> instances for simple measurement.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">rho</span> <span class="o">=</span> <span class="n">random_state</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">pvm</span><span class="p">)</span>  <span class="c1"># same as Measure(pvm)(rho)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The probability distribution of outcome&quot;</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span>
<span class="n">prob</span><span class="p">,</span> <span class="n">collapsed_state</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span>
    <span class="n">pvm</span><span class="p">,</span> <span class="n">keep_state</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>  <span class="c1"># same as Measure(pvm)(rho, keep_state=True)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The collapsed state for each outcome is&quot;</span><span class="p">,</span> <span class="n">collapsed_state</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The probability distribution of outcome tensor([0.1429, 0.8571])
The collapsed state for each outcome is
-----------------------------------------------------
 Backend: density_matrix
 System dimension: [2]
 System sequence: [0]
 Batch size: [2]

 # 0:
[[0.5+0.j 0.5+0.j]
 [0.5+0.j 0.5+0.j]]
 # 1:
[[ 0.5+0.j -0.5+0.j]
 [-0.5+0.j  0.5+0.j]]
-----------------------------------------------------

</pre></div></div>
</div>
<h3 id="Positive-operator-valued-measurement">Positive operator-valued measurement<a class="headerlink" href="#Positive-operator-valued-measurement" title="Link to this heading">¶</a></h3>
<p>POVMs are the generalization of PVMs, describing the effect on a subsystem of a projective measurement performed on a larger system. In QuAIRKit, we can perform positive operator-valued measurement by <code class="docutils literal notranslate"><span class="pre">State.measure</span></code>, with <code class="docutils literal notranslate"><span class="pre">is_povm</span></code> set to True.</p>
<p>Computation for POVM is often more efficient than that for PVM, as it directly computes the probability. However, its potential lack of a unique post-measurement state makes it less useful in practice.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">pvm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time for measuring with pvm: </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">:</span><span class="s2">.10f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>


<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">rho</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">pvm</span><span class="p">,</span> <span class="n">is_povm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time for measuring with povm: </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_time</span><span class="si">:</span><span class="s2">.10f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">rho</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">pvm</span><span class="p">,</span> <span class="n">is_povm</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_state</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
    <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Time for measuring with pvm: 0.0000000000s
Time for measuring with povm: 0.0000000000s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Traceback (most recent call last):
  File &#34;C:\Users\Cloud\AppData\Local\Temp\ipykernel_18632\2671688636.py&#34;, line 11, in &lt;module&gt;
    rho.measure(pvm, is_povm=True, keep_state=True)
  File &#34;c:\users\cloud\quairkit-dev\quairkit\core\state\backend\__init__.py&#34;, line 757, in measure
    raise ValueError(
ValueError: `is_povm` and `keep_state` cannot be both True, since a general POVM does not distinguish states.
</pre></div></div>
</div>
<h2 id="Batch-measurement">Batch measurement<a class="headerlink" href="#Batch-measurement" title="Link to this heading">¶</a></h2>
<p>QuAIRKit supports batched measurement under the broadcasting rule, which includes either one or multiple PVMs, one or multiple input states, or both. This means that users can perform different measurements at the same time. The broadcasting rule is summarized as follows:</p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>PVM with size m</p></th>
<th class="head"><p>State</p></th>
<th class="head"><p>Probability</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>[None, …]</p></td>
<td><p>[None, …]</p></td>
<td><p>[m]</p></td>
</tr>
<tr class="row-odd"><td><p>[None, …]</p></td>
<td><p>[n, …]</p></td>
<td><p>[n, m]</p></td>
</tr>
<tr class="row-even"><td><p>[n, …]</p></td>
<td><p>[None, …]</p></td>
<td><p>[n, m]</p></td>
</tr>
<tr class="row-odd"><td><p>[n, …]</p></td>
<td><p>[n, …]</p></td>
<td><p>[n, m]</p></td>
</tr>
<tr class="row-even"><td><p>[n, …]</p></td>
<td><p>[p, …]</p></td>
<td><p>Error</p></td>
</tr>
</tbody>
</table>
<p>Here the first dimension indicates the batch size of PVMs and input states.</p>
<ul class="simple">
<li><p>The first row refers to 1 PVM set with m elements, and 1 state to be measured, so there is m outcomes to form a probability distribution.</p></li>
<li><p>The second row means there is 1 PVM set with m elements, and n state to be measured. Therefore, same measurement is implemented for different states.</p></li>
<li><p>The third row denotes n PVM sets with m elements, and 1 state to be measured. Different measurements will be executed for one state.</p></li>
<li><p>The fourth row means there are n PVM sets with m elements each and n states, to perform corresponding measurements for every state.</p></li>
</ul>
<p>Notice that the number of PVM sets should be consistent with the number of states, as it is shown in the last row.</p>
<p>Users can also initialize a batch Measure instance via a Pauli string, or directly input the batched PVM in <em>torch.Tensor</em>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">op</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">([</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">])</span>  <span class="c1"># measure states by x, y, z basis, respectively</span>

<span class="n">list_pvm</span> <span class="o">=</span> <span class="n">pauli_str_povm</span><span class="p">([</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The tensor shape of the measurement: </span><span class="si">{</span><span class="n">list_pvm</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">op</span> <span class="o">=</span> <span class="n">Measure</span><span class="p">(</span><span class="n">list_pvm</span><span class="p">)</span>  <span class="c1"># equivalent to Measure([&#39;x&#39;, &#39;y&#39;, &#39;z&#39;])</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The tensor shape of the measurement: torch.Size([3, 2, 2, 2])
</pre></div></div>
</div>
<p>As shown by the above table, users are able to apply <code class="docutils literal notranslate"><span class="pre">Measure</span></code> to a single state,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">prob</span><span class="p">,</span> <span class="n">collapsed_state</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">keep_state</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The measured states for the first batch is&quot;</span><span class="p">,</span>
    <span class="n">collapsed_state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="sa">f</span><span class="s2">&quot;with prob distribution </span><span class="si">{</span><span class="n">prob</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The measured states for the first batch is
-----------------------------------------------------
 Backend: density_matrix
 System dimension: [2]
 System sequence: [0]
 Batch size: [2]

 # 0:
[[0.5+0.j 0.5+0.j]
 [0.5+0.j 0.5+0.j]]
 # 1:
[[ 0.5+0.j -0.5+0.j]
 [-0.5+0.j  0.5+0.j]]
-----------------------------------------------------
 with prob distribution tensor([0.1429, 0.8571])
</pre></div></div>
</div>
<p>or apply <code class="docutils literal notranslate"><span class="pre">Measure</span></code> to a batched state. Note that the batch dimension needs to be matched.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">list_rho</span> <span class="o">=</span> <span class="n">random_state</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>

<span class="n">prob</span><span class="p">,</span> <span class="n">collapsed_state</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="n">list_rho</span><span class="p">,</span> <span class="n">keep_state</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;The measured states for the first batch is&quot;</span><span class="p">,</span>
    <span class="n">collapsed_state</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="sa">f</span><span class="s2">&quot;with prob distribution </span><span class="si">{</span><span class="n">prob</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The measured states for the first batch is
-----------------------------------------------------
 Backend: state_vector
 System dimension: [2]
 System sequence: [0]
 Batch size: [2]

 # 0:
[0.41-0.58j 0.41-0.58j]
 # 1:
[ 0.47+0.53j -0.47-0.53j]
-----------------------------------------------------
 with prob distribution tensor([0.1383, 0.8617])
</pre></div></div>
</div>
<h2 id="Sampled-measurements">Sampled measurements<a class="headerlink" href="#Sampled-measurements" title="Link to this heading">¶</a></h2>
<p>Users can use <code class="docutils literal notranslate"><span class="pre">quairkit.qinfo.prob_sample</span></code> to determine shots of measurement based on given probability distributions. The function is used to simulate the outcomes of quantum measurements. When users perform a quantum measurement, the result is probabilistic, namely, outcomes are generated with different probabilities. The <code class="docutils literal notranslate"><span class="pre">prob_sample</span></code> function allows users to simulate this by generating samples (or “shots”) based on a provided probability distribution.</p>
<p>For example, if users simulate 1024 shots, the output might be</p>
<div class="highlight-plaintext notranslate"><div class="highlight"><pre><span></span><code>{&#39;00&#39;: tensor([98, ...]), &#39;01&#39;: tensor([230, ...]), &#39;10&#39;: tensor([300, ...]), &#39;11&#39;: tensor([396, ...])}
</code></pre></div>
</div>
<p>which means that:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">00</span></code> occurred 98 times,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">01</span></code> occurred 230 times,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">10</span></code> occurred 300 times,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">11</span></code> occurred 396 times.</p></li>
</ul>
<p>Users can also adjust the argument <code class="docutils literal notranslate"><span class="pre">binary</span></code> and <code class="docutils literal notranslate"><span class="pre">proportional</span></code> to change the output format:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">binary</span></code> is False: the dictionary index is in the decimal system.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proportional</span></code> is True: values are transformed into proportions.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2"> probability distributions are</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The outcomes of quantum measurements:</span><span class="se">\n</span><span class="si">{</span><span class="n">prob_sample</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The outcomes of quantum measurements with the decimal system of dictionary system:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">prob_sample</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The outcomes of quantum measurements in proportion:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">prob_sample</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">proportional</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
<span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
3 probability distributions are
 tensor([[0.1383, 0.8617],
        [0.7877, 0.2123],
        [0.2835, 0.7165]])

The outcomes of quantum measurements:
{&#39;0&#39;: tensor([136, 806, 271]), &#39;1&#39;: tensor([888, 218, 753])}

The outcomes of quantum measurements with the decimal system of dictionary system:
 {&#39;0&#39;: tensor([146, 800, 309]), &#39;1&#39;: tensor([878, 224, 715])}

The outcomes of quantum measurements in proportion:
 {&#39;0&#39;: tensor([0.1299, 0.7881, 0.2803]), &#39;1&#39;: tensor([0.8701, 0.2119, 0.7197])}
</pre></div></div>
</div>
<hr class="docutils" />
<h2 id="References">References<a class="headerlink" href="#References" title="Link to this heading">¶</a></h2>
<p>[1] Nielsen, Michael A., and Isaac L. Chuang. Quantum computation and quantum information. Vol. 2. Cambridge: Cambridge university press, 2001.</p>
<p><em>Table: A reference of notation conventions in this tutorial.</em></p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Variant</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(p\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(p(x),p(m)\)</span></p></td>
<td><p>probability distribution</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(M_m\)</span></p></td>
<td></td>
<td><p>measurement operator</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(M_m^\dagger\)</span></p></td>
<td></td>
<td><p>conjugate transpose of <span class="math notranslate nohighlight">\(M_m\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\{\vert m \rangle \langle m \vert\}\)</span></p></td>
<td></td>
<td><p>computational basis</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\delta_{m,m'}\)</span></p></td>
<td></td>
<td><p>Kronecker delta</p></td>
</tr>
</tbody>
</table>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">qkit</span><span class="o">.</span><span class="n">print_info</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

---------VERSION---------
quairkit: 0.4.0
torch: 2.7.0+cpu
numpy: 1.26.0
scipy: 1.14.1
matplotlib: 3.10.0
---------SYSTEM---------
Python version: 3.10.16
OS: Windows
OS version: 10.0.26100
---------DEVICE---------
CPU: ARMv8 (64-bit) Family 8 Model 1 Revision 201, Qualcomm Technologies Inc
</pre></div></div>
</div>







  
  






                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2024, QuAIR.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    8.1.3.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike", "staticVersions": null, "versionPath": null}}</script>
    
      
        <script src="../../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>
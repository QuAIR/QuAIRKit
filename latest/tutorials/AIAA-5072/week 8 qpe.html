


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="week%207%20qaa.html">
      
      
        <link rel="next" href="week%209%20hamiltonian.html">
      
      
      <link rel="icon" href="../../_static/favicon.svg">
    
    
      
        <title>Quantum phase estimation - QuAIRKit</title>
      
    
    
      
        
      
      


    
    
      
    
    
      
        
        
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
        <link rel="stylesheet" type="text/css" href="../../_static/sphinx_immaterial_theme.6ec1c446c2c357833.min.css?v=e2e8fea8" />
        <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#Introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="QuAIRKit" class="md-header__button md-logo" aria-label="QuAIRKit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QuAIRKit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Quantum phase estimation
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/QuAIR/QuAIRKit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    QuAIRKit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="QuAIRKit" class="md-nav__button md-logo" aria-label="QuAIRKit" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>
    </a>
    QuAIRKit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/QuAIR/QuAIRKit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    QuAIRKit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quairkit.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/quairkit.rst (reference label)"><span>quairkit</span></span>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/tutorials.rst (reference label)"><span>tutorials</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            <span title="/tutorials.rst (reference label)"><span>tutorials</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tutorials.AIAA-5072.html" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <span title="/tutorials.aiaa-5072.rst (reference label)"><span>tutorials.<wbr>AIAA-<wbr>5072</span></span>
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            <span title="/tutorials.aiaa-5072.rst (reference label)"><span>tutorials.<wbr>AIAA-<wbr>5072</span></span>
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="week%201%20qubit.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/aiaa-5072/week 1 qubit.ipynb (reference label)"><span>Brief Introduction to Quantum Computing</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="week%202%20quasi.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/aiaa-5072/week 2 quasi.ipynb (reference label)"><span>Quantum error mitigation</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="week%203%20vqe.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/aiaa-5072/week 3 vqe.ipynb (reference label)"><span>Variational quantum eigensolver</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="week%204%20entanglement.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/aiaa-5072/week 4 entanglement.ipynb (reference label)"><span>Entanglement</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="week%205%20superdense-coding.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/aiaa-5072/week 5 superdense-coding.ipynb (reference label)"><span>Superdense coding</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="week%206%20teleportation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/aiaa-5072/week 6 teleportation.ipynb (reference label)"><span>Quantum state teleportation</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="week%207%20qaa.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/aiaa-5072/week 7 qaa.ipynb (reference label)"><span>Quantum state amplitude amplification</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/aiaa-5072/week 8 qpe.ipynb (reference label)"><span>Quantum phase estimation</span></span>
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="#" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/aiaa-5072/week 8 qpe.ipynb (reference label)"><span>Quantum phase estimation</span></span>
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Introduction" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/aiaa-5072/week 8 qpe.ipynb#introduction (reference label)"><span>Introduction</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Quantum-phase-estimation-algorithm" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/aiaa-5072/week 8 qpe.ipynb#quantum-phase-estimation-algorithm (reference label)"><span>Quantum phase estimation algorithm</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Extension" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/aiaa-5072/week 8 qpe.ipynb#extension (reference label)"><span>Extension</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extension">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Random-input-state" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/aiaa-5072/week 8 qpe.ipynb#random-input-state (reference label)"><span>Random input state</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Quantum-amplitude-estimation-algorithm" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/aiaa-5072/week 8 qpe.ipynb#quantum-amplitude-estimation-algorithm (reference label)"><span>Quantum amplitude estimation algorithm</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#References" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/aiaa-5072/week 8 qpe.ipynb#references (reference label)"><span>References</span></span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="week%209%20hamiltonian.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials/aiaa-5072/week 9 hamiltonian.ipynb (reference label)"><span>Hamiltonian simulation</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials.feature.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials.feature.rst (reference label)"><span>tutorials.<wbr>feature</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials.introduction.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials.introduction.rst (reference label)"><span>tutorials.<wbr>introduction</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials.research.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <span title="/tutorials.research.rst (reference label)"><span>tutorials.<wbr>research</span></span>
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#Introduction" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/aiaa-5072/week 8 qpe.ipynb#introduction (reference label)"><span>Introduction</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Quantum-phase-estimation-algorithm" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/aiaa-5072/week 8 qpe.ipynb#quantum-phase-estimation-algorithm (reference label)"><span>Quantum phase estimation algorithm</span></span>
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#Extension" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/aiaa-5072/week 8 qpe.ipynb#extension (reference label)"><span>Extension</span></span>
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Extension">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#Random-input-state" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/aiaa-5072/week 8 qpe.ipynb#random-input-state (reference label)"><span>Random input state</span></span>
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#Quantum-amplitude-estimation-algorithm" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/aiaa-5072/week 8 qpe.ipynb#quantum-amplitude-estimation-algorithm (reference label)"><span>Quantum amplitude estimation algorithm</span></span>
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#References" class="md-nav__link">
    
    <span class="md-ellipsis">
      <span title="/tutorials/aiaa-5072/week 8 qpe.ipynb#references (reference label)"><span>References</span></span>
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset" role="main">
                
                
                  


<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[ ]:
</code></pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span><code>%%bash
<span class="k">if</span><span class="w"> </span>!<span class="w"> </span>python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import quairkit&quot;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>pip<span class="w"> </span>install<span class="w"> </span>quairkit
<span class="k">fi</span>

<span class="k">if</span><span class="w"> </span>!<span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>pdftotext<span class="w"> </span><span class="p">&amp;</span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span>conda<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>poppler
<span class="k">fi</span>
</code></pre></div>
</div>
</div>
<h1 id="Quantum-phase-estimation">Quantum phase estimation<a class="headerlink" href="#Quantum-phase-estimation" title="Link to this heading">¶</a></h1>
<p>Copyright (c) 2025 QuAIR team. All Rights Reserved.</p>
<p>In this tutorial, we will introduce the Quantum Phase Estimation (QPE) algorithm and its applications, as well as how to implement it in QuAIRKit. In addition, we will also present a special case of the QPE algorithm – the Quantum Amplitude Estimation (QAE) algorithm.</p>
<p><strong>Table of Contents</strong></p>
<ul class="simple">
<li><p><a class="reference internal" href="#Introduction"><span class="std std-ref">Introduction</span></a></p></li>
<li><p><a class="reference internal" href="#Quantum-phase-estimation-algorithm"><span class="std std-ref">Quantum phase estimation algorithm</span></a></p></li>
<li><p><a class="reference internal" href="#Extension"><span class="std std-ref">Extension</span></a></p>
<ul>
<li><p><a class="reference internal" href="#Random-input-state"><span class="std std-ref">Random input state</span></a></p></li>
<li><p><a class="reference internal" href="#Quantum-amplitude-estimation-algorithm"><span class="std std-ref">Quantum amplitude estimation algorithm</span></a></p></li>
</ul>
</li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[2]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">import</span> <span class="nn">quairkit</span> <span class="k">as</span> <span class="nn">qkit</span>
<span class="kn">from</span> <span class="nn">quairkit</span> <span class="kn">import</span> <span class="n">Circuit</span><span class="p">,</span> <span class="n">to_state</span>
<span class="kn">from</span> <span class="nn">quairkit.database</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">quairkit.qinfo</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">qkit</span><span class="o">.</span><span class="n">set_dtype</span><span class="p">(</span><span class="s2">&quot;complex128&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">font_family</span> <span class="o">=</span> <span class="s1">&#39;STIXGeneral&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;mathtext.fontset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cm&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">font_family</span>
</code></pre></div>
</div>
</div>
<h2 id="Introduction">Introduction<a class="headerlink" href="#Introduction" title="Link to this heading">¶</a></h2>
<p>In quantum mechanics, a unitary operator <span class="math notranslate nohighlight">\(U\)</span> often represents the time evolution of a system. When <span class="math notranslate nohighlight">\(U\)</span> takes the form <span class="math notranslate nohighlight">\(U = e^{iH}\)</span>, where <span class="math notranslate nohighlight">\(H\)</span> is the Hamiltonian, it characterizes the energy structure of the system. If <span class="math notranslate nohighlight">\(|\psi\rangle\)</span> is an eigenstate of <span class="math notranslate nohighlight">\(U\)</span>, then <span class="math notranslate nohighlight">\(U|\psi\rangle = e^{i\theta}|\psi\rangle\)</span>, where <span class="math notranslate nohighlight">\(e^{i\theta}\)</span> is the corresponding eigenvalue. The parameter <span class="math notranslate nohighlight">\(\theta\)</span> is called the eigenphase. Since <span class="math notranslate nohighlight">\(U = e^{iH}\)</span>, the
eigenphase <span class="math notranslate nohighlight">\(\theta\)</span> corresponds to an energy eigenvalue of <span class="math notranslate nohighlight">\(H\)</span>. The goal of the Quantum Phase Estimation (<strong>QPE</strong>) algorithm is to estimate the eigenphase <span class="math notranslate nohighlight">\(\theta\)</span> of <span class="math notranslate nohighlight">\(U\)</span>, given access to <span class="math notranslate nohighlight">\(U\)</span> and its eigenstate, thereby obtaining information about the system’s energy spectrum.</p>
<p>Here, we randomly generate a unitary <span class="math notranslate nohighlight">\(U\)</span> for the experiment, that is, we need to estimate the eigenphase of <span class="math notranslate nohighlight">\(U\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[3]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">dim_main</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">random_unitary</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">system_dim</span><span class="o">=</span><span class="n">dim_main</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p>The problem that QPE addresses can be formally stated as follows:</p>
<p>Given a unitary operator <span class="math notranslate nohighlight">\(U\)</span> and one of its eigenstates <span class="math notranslate nohighlight">\(| \psi\rangle\)</span>, satisfying <span class="math notranslate nohighlight">\(U | \psi\rangle = e^{2\pi i x} | \psi\rangle,\)</span> where <span class="math notranslate nohighlight">\(x \in [0, 1]\)</span> is the eigenphase corresponding to this eigenvalue, the goal of QPE is to estimate the real number <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>Note: In <span class="math notranslate nohighlight">\(U|\psi\rangle = e^{i\theta}|\psi\rangle\)</span>, since the complex exponential function is <span class="math notranslate nohighlight">\(2\pi\)</span>-periodic, the eigenphase <span class="math notranslate nohighlight">\(\theta\)</span> is not unique. To avoid ambiguity, we define <span class="math notranslate nohighlight">\(\theta = 2\pi x\)</span>, thereby restricting <span class="math notranslate nohighlight">\(x\)</span> to the interval <span class="math notranslate nohighlight">\([0, 1]\)</span>. In what follows, we uniformly refer to <span class="math notranslate nohighlight">\(x\)</span> as the phase.</p>
<p>Here, we randomly select one 10-dimensional eigenstate of <span class="math notranslate nohighlight">\(U\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[4]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim_main</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,))</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="n">eigenvalue</span> <span class="o">=</span> <span class="n">eigvals</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">psi</span> <span class="o">=</span> <span class="n">to_state</span><span class="p">(</span><span class="n">eigvecs</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">],</span> <span class="n">system_dim</span><span class="o">=</span><span class="n">dim_main</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected eigenstate |ψ</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">⟩ as the input state for the subsequent example&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Selected eigenstate |ψ7⟩ as the input state for the subsequent example
</pre></div></div>
</div>
<p>QPE takes a unitary operator <span class="math notranslate nohighlight">\(U\)</span> and one of its eigenstates <span class="math notranslate nohighlight">\(| \psi\rangle\)</span> as input. Using <span class="math notranslate nohighlight">\(n\)</span> auxiliary qubits and a total of <span class="math notranslate nohighlight">\(2^n\)</span> control-<span class="math notranslate nohighlight">\(U\)</span>, it outputs an <span class="math notranslate nohighlight">\(n\)</span>-bit binary approximation <span class="math notranslate nohighlight">\(x_1 x_2 \ldots x_n \in \{0,1\}^n\)</span> such that</p>
<div class="math notranslate nohighlight">
\[U | \psi\rangle = e^{2\pi i x} | \psi\rangle,\tag{1}\]</div>
<p>where <span class="math notranslate nohighlight">\(x \in [0,1]\)</span> is the eigenphase of <span class="math notranslate nohighlight">\(U\)</span> corresponding to <span class="math notranslate nohighlight">\(| \psi\rangle\)</span>.</p>
<h2 id="Quantum-phase-estimation-algorithm">Quantum phase estimation algorithm<a class="headerlink" href="#Quantum-phase-estimation-algorithm" title="Link to this heading">¶</a></h2>
<p>The quantum phase estimation algorithm was first proposed by Alexei Kitaev in 1995, when he introduced the idea of measuring the eigenphase of a unitary operator while studying Abelian stabilizer problems, and proposed a quantum measurement scheme based on eigenstates [1]. Almost simultaneously, Peter Shor used the quantum Fourier transform (QFT) and controlled powers of unitary operations to extract the period of modular exponentiation in his factoring algorithm, which is an instance of QPE
[2].</p>
<p>Subsequently, Cleve, Ekert, Macchiavello, and Mosca systematized the idea of QFT and eigenvalue estimation, developing the standard QPE algorithmic framework familiar today [3]. This framework includes controlled powers <span class="math notranslate nohighlight">\(U^{2^j}\)</span>, the quantum Fourier transform, and measurement. Since then, QPE has become a fundamental module for many quantum algorithms, such as the Harrow–Hassidim–Lloyd (HHL) algorithm for solving linear systems [4], energy eigenvalue estimation in quantum chemistry [5],
and later developments like quantum amplitude estimation (QAE).</p>
<p>It should be emphasized that <strong>QPE itself does not provide quantum speedup</strong>, because its main computational tasks—the Fourier transform and measurement—are essentially classical-like. The true quantum advantage arises when <span class="math notranslate nohighlight">\(U^{2^j}\)</span> can be efficiently implemented using <span class="math notranslate nohighlight">\(\operatorname{poly}(n)\)</span> resources. For example, in Shor’s algorithm, control-<span class="math notranslate nohighlight">\(U^{2^j}\)</span> represents modular exponentiation, which can be constructed with quantum circuits in polynomial time, thus enabling
exponential speedup in extracting the periodic structure. This is the fundamental reason why QPE enables Shor’s algorithm to achieve exponential advantage.</p>
<p>The algorithm runs on two sets of qudits: the first set is an auxiliary system composed of <span class="math notranslate nohighlight">\(n\)</span> qubits, and the second set is the main system composed of a single qudit.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[5]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">num_ancilla_qubits</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">cir</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="n">num_ancilla_qubits</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">system_dim</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_ancilla_qubits</span> <span class="o">+</span> <span class="p">[</span><span class="n">dim_main</span><span class="p">])</span>
</code></pre></div>
</div>
</div>
<p>Prepare the input state <span class="math notranslate nohighlight">\(| \Psi_0\rangle = | 0\rangle^{\otimes n} | \psi\rangle:\)</span></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[6]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">input_state</span> <span class="o">=</span> <span class="n">nkron</span><span class="p">(</span><span class="n">zero_state</span><span class="p">(</span><span class="n">num_ancilla_qubits</span><span class="p">),</span> <span class="n">psi</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p><strong>First step:</strong> Apply <span class="math notranslate nohighlight">\(H\)</span></p>
<p>We apply the tensor product of <span class="math notranslate nohighlight">\(n\)</span> Hadamard gates <span class="math notranslate nohighlight">\(H^{\otimes n}\)</span> on the auxiliary system, obtaining the quantum state:</p>
<div class="math notranslate nohighlight">
\[|\Psi_1\rangle = (H^{\otimes n} \otimes I) |\Psi_0\rangle
= \frac{1}{2^{n/2}} (|0\rangle + |1\rangle)^{\otimes n} |\psi\rangle \tag{2}
= \frac{1}{2^{n/2}} \sum_{j=0}^{2^n - 1} |j\rangle |\psi\rangle.\]</div>
<p>On the right-hand side, <span class="math notranslate nohighlight">\(|j\rangle\)</span> is a shorthand for the tensor product of <span class="math notranslate nohighlight">\(n\)</span> qubits: <span class="math notranslate nohighlight">\(|j\rangle \coloneqq \bigotimes_{\ell=0}^{n-1} |j_\ell\rangle,\)</span> where <span class="math notranslate nohighlight">\(j = \sum_{\ell=0}^{n-1} j_\ell 2^\ell\)</span> is the binary expansion of <span class="math notranslate nohighlight">\(j\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[7]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">cir</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_ancilla_qubits</span><span class="p">)))</span>
</code></pre></div>
</div>
</div>
<p><strong>Second step:</strong> Apply Controlled-<span class="math notranslate nohighlight">\(U\)</span> operations</p>
<p>Define the linear combination of unitaries <span class="math notranslate nohighlight">\(U^0, U^1, \ldots, U^{2^n-1}\)</span> as <span class="math notranslate nohighlight">\(CU\)</span>:</p>
<div class="math notranslate nohighlight">
\[CU = \sum_{k=0}^{2^n - 1} |k\rangle \langle k| \otimes U^k.\tag{3}\]</div>
<p>Then we have <span class="math notranslate nohighlight">\(CU (|k\rangle \otimes |\psi\rangle) = |k\rangle \otimes \left(U^k |\psi\rangle \right),\)</span> meaning that when the auxiliary system is in the state <span class="math notranslate nohighlight">\(|k\rangle\)</span>, the corresponding operation <span class="math notranslate nohighlight">\(U^k\)</span> is applied to the main system.</p>
<p>Since <span class="math notranslate nohighlight">\(U^k |\psi\rangle = e^{2\pi i x k } |\psi\rangle\)</span>, applying <span class="math notranslate nohighlight">\(CU\)</span> to <span class="math notranslate nohighlight">\(|\Psi_1\rangle\)</span> gives:</p>
<div class="math notranslate nohighlight">
\[|\Psi_2\rangle = CU |\Psi_1\rangle = \left( \frac{1}{2^{n/2}} \sum_{k=0}^{2^n - 1} e^{2\pi i x k} |k\rangle \right) \otimes |\psi\rangle.\tag{4}\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[8]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_ancilla_qubits</span><span class="p">):</span>
    <span class="n">cir</span><span class="o">.</span><span class="n">oracle</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">k</span><span class="p">),</span> <span class="p">[</span><span class="n">num_ancilla_qubits</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_ancilla_qubits</span><span class="p">],</span> <span class="n">control_idx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;U^{</span><span class="si">%d</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">k</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<p><strong>Third step:</strong> Apply the inverse quantum Fourier transform (QFT) <span class="math notranslate nohighlight">\(\operatorname{QFT}^{-1}\)</span> on the auxiliary system.</p>
<p>The action of the QFT and its inverse is defined on the standard computational basis as:</p>
<div class="math notranslate nohighlight">
\[\operatorname{QFT}_N | k\rangle = \frac{1}{\sqrt{N}} \sum_{j=0}^{N-1} e^{\frac{2\pi i}{N} jk} | j\rangle, \quad
\operatorname{QFT}_N^{-1} | k\rangle = \frac{1}{\sqrt{N}} \sum_{j=0}^{N-1} e^{-\frac{2\pi i}{N} jk} | j\rangle. \tag{5}\]</div>
<p>Therefore,</p>
<div class="math notranslate nohighlight">
\[| \Psi_3\rangle = (\operatorname{QFT}_{2^n}^{-1} \otimes I) | \Psi_2\rangle = \frac{1}{2^{n/2}} \sum_{k=0}^{2^n - 1} e^{2\pi i x k} \left( \frac{1}{2^{n/2}} \sum_{j=0}^{2^n - 1} e^{-\frac{2\pi i kj}{2^n}} | j\rangle \right) \otimes |\psi\rangle = \frac{1}{2^n} \sum_{j=0}^{2^n - 1} \sum_{k=0}^{2^n - 1} e^{-\frac{2\pi i k}{2^n}(j - 2^n x)} | j\rangle \otimes |\psi\rangle. \tag{6}\]</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[9]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">qft_inverse</span> <span class="o">=</span> <span class="n">dagger</span><span class="p">(</span><span class="n">qft_matrix</span><span class="p">(</span><span class="n">num_ancilla_qubits</span><span class="p">))</span>
<span class="n">cir</span><span class="o">.</span><span class="n">oracle</span><span class="p">(</span><span class="n">qft_inverse</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_ancilla_qubits</span><span class="p">)),</span>  <span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\operatorname</span><span class="si">{QFT}</span><span class="s1">_{</span><span class="si">%d</span><span class="s1">}^{-1}&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">num_ancilla_qubits</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<p><strong>Fourth step:</strong> Perform measurement at the end.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[10]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">cir</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_ancilla_qubits</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Circuit for implementing QPE&quot;</span><span class="p">)</span>
<span class="n">cir</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Circuit for implementing QPE
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_AIAA-5072_week_8_qpe_22_1.png" src="../../_images/tutorials_AIAA-5072_week_8_qpe_22_1.png" />
</div>
</div>
<p>Obtain the measurement result. In the simulator environment, we can directly obtain the probability distribution of possible measurement outcomes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[11]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">output_state</span> <span class="o">=</span> <span class="n">cir</span><span class="p">(</span><span class="n">input_state</span><span class="p">)</span>
<span class="n">probs</span> <span class="o">=</span> <span class="n">output_state</span><span class="o">.</span><span class="n">probability</span>
</code></pre></div>
</div>
</div>
<p>Expand the auxiliary system in the computational basis: <span class="math notranslate nohighlight">\(| \Psi_3\rangle = \sum_{j=0}^{2^n - 1} c_j | j\rangle,\)</span> where the coefficients are</p>
<div class="math notranslate nohighlight">
\[c_j = \langle j | \Psi_3\rangle = \frac{1}{2^n} \sum_{k=0}^{2^n - 1} e^{-\frac{2\pi i k}{2^n}(j - 2^n x)}
= \frac{1}{2^n} \sum_{k=0}^{2^n - 1} e^{-2\pi i \frac{k}{2^n}(j - a)} e^{2\pi i \delta k}. \tag{7}\]</div>
<p>Let <span class="math notranslate nohighlight">\(2^n x = a + 2^n \delta\)</span>, where <span class="math notranslate nohighlight">\(a\)</span> is the integer closest to <span class="math notranslate nohighlight">\(2^n x\)</span>, and <span class="math notranslate nohighlight">\(\delta\)</span> is the fractional part of the difference, satisfying <span class="math notranslate nohighlight">\(0 \le |2^n \delta| \le \frac{1}{2}.\)</span></p>
<p>Measure the auxiliary system in the computational basis. The probability of obtaining the outcome <span class="math notranslate nohighlight">\(|y\rangle\)</span> is</p>
<div class="math notranslate nohighlight">
\[\Pr(y) = |c_y|^2 = \left| \frac{1}{2^n} \sum_{k=0}^{2^n - 1} e^{-2\pi i \frac{k}{2^n}(y - a)} e^{2\pi i \delta k} \right|^2. \tag{8}\]</div>
<p><strong>Theorem.</strong> <span class="math notranslate nohighlight">\(\Pr(y)\)</span> achieves its maximum at <span class="math notranslate nohighlight">\(y = a\)</span></p>
<p><strong>Proof.</strong> Let <span class="math notranslate nohighlight">\(N = 2^n\)</span>, and define the integer <span class="math notranslate nohighlight">\(d = y - a\)</span>, then the phase difference is <span class="math notranslate nohighlight">\(\theta_d = \delta - \frac{d}{N}\)</span>. Thus, <span class="math notranslate nohighlight">\(c_y = \frac{1}{2^n} \sum_{k=0}^{N-1} e^{2\pi i k \theta_d},\)</span> which is a geometric series. Using the formula <span class="math notranslate nohighlight">\(\sum_{k=0}^{N-1} r^k = \frac{1 - r^N}{1 - r}\)</span> with <span class="math notranslate nohighlight">\(r = e^{2\pi i \theta_d}\)</span>, we get <span class="math notranslate nohighlight">\(|c_y| = \left| \frac{1}{N} \cdot \frac{1 - e^{2\pi i N \theta_d}}{1 - e^{2\pi i \theta_d}} \right|.\)</span> Using the modulus property of
complex numbers <span class="math notranslate nohighlight">\(|1 - e^{i\alpha}| = 2 |\sin(\alpha / 2)|\)</span>, we have <span class="math notranslate nohighlight">\(|1 - e^{2\pi i N \theta_d}| = 2 |\sin(\pi N \theta_d)|, |1 - e^{2\pi i \theta_d}| = 2 |\sin(\pi \theta_d)|.\)</span> Hence, <span class="math notranslate nohighlight">\(|c_y| = \frac{1}{N} \cdot \frac{|\sin(\pi N \theta_d)|}{|\sin(\pi \theta_d)|}.\)</span></p>
<p>The probability can be expressed as</p>
<div class="math notranslate nohighlight">
\[\Pr(y) = \frac{1}{N^2} \cdot \frac{\sin^2(\pi \theta_d N)}{\sin^2(\pi \theta_d)},  \theta_d = \delta - \frac{d}{N}. \tag{9}\]</div>
<p>Denote <span class="math notranslate nohighlight">\(\frac{\sin^2(\pi N \theta)}{\sin^2(\pi \theta)} = f(\theta)\)</span>, so that <span class="math notranslate nohighlight">\(\Pr(y) = \frac{1}{N^2} f(\theta_d).\)</span></p>
<p>The function <span class="math notranslate nohighlight">\(f(\theta)\)</span> has the following properties:</p>
<ul class="simple">
<li><p>Strictly decreasing on <span class="math notranslate nohighlight">\([0, \frac{1}{2N}]\)</span>.</p></li>
<li><p>For any <span class="math notranslate nohighlight">\(\theta \in [\frac{1}{2N}, 0.5)\)</span>, we have <span class="math notranslate nohighlight">\(f(\theta) = \frac{\sin^2(\pi N \theta)}{\sin^2(\pi \theta)} \le \frac{1}{\sin^2(\pi \theta)} \le \frac{1}{\sin^2(\pi / (2N))} = f\left(\frac{1}{2N}\right),\)</span> because <span class="math notranslate nohighlight">\(|\sin(\pi N \theta)| \le 1\)</span> and <span class="math notranslate nohighlight">\(\sin(\pi \theta)\)</span> is monotonically increasing on <span class="math notranslate nohighlight">\([0, 0.5]\)</span>, so for <span class="math notranslate nohighlight">\(\theta \ge \frac{1}{2N}\)</span>, we have <span class="math notranslate nohighlight">\(\sin(\pi \theta) \ge \sin(\pi / (2N))\)</span>. Therefore, on this interval:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[f(\theta) \le f\left(\frac{1}{2N}\right). \tag{10}\]</div>
<p>Since <span class="math notranslate nohighlight">\(0 \le |2^n \delta| \le 1/2\)</span>, we have <span class="math notranslate nohighlight">\(|\delta| \le 1/(2N)\)</span>, and <span class="math notranslate nohighlight">\(d = y - a\)</span> is an integer:</p>
<ul class="simple">
<li><p>If <span class="math notranslate nohighlight">\(d = 0\)</span>, then <span class="math notranslate nohighlight">\(\theta_0 = \delta\)</span>, so <span class="math notranslate nohighlight">\(|\theta_0| = |\delta| \le 1/(2N)\)</span>.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(d \ne 0\)</span>, since <span class="math notranslate nohighlight">\(|d| \ge 1\)</span>, we have <span class="math notranslate nohighlight">\(|\theta_d| = \left| \delta - \frac{d}{N} \right| \ge \left| \frac{|d|}{N} - |\delta| \right| \ge \frac{1}{N} - \frac{1}{2N} = \frac{1}{2N}.\)</span> Equality holds only if <span class="math notranslate nohighlight">\(|d| = 1\)</span> and <span class="math notranslate nohighlight">\(|\delta| = 1/(2N)\)</span>.</p></li>
</ul>
<p>Hence, <span class="math notranslate nohighlight">\(|\theta_d| \ge 1/(2N), |\theta_0| \le 1/(2N), f(|\theta_d|) \le f(1/(2N)) \le f(|\theta_0|) = f(\theta_0).\)</span></p>
<p>Therefore,</p>
<div class="math notranslate nohighlight">
\[\Pr(y) = \frac{1}{N^2} f(\theta_d) \le \frac{1}{N^2} f(\theta_0) = \Pr(a).\tag{11}\]</div>
<p>Equality occurs only in the boundary case <span class="math notranslate nohighlight">\(|d| = 1\)</span> and <span class="math notranslate nohighlight">\(|\delta| = 1/(2N)\)</span>.</p>
<p>In conclusion, <span class="math notranslate nohighlight">\(\Pr(y)\)</span> achieves its maximum at <span class="math notranslate nohighlight">\(y = a\)</span> (i.e., <span class="math notranslate nohighlight">\(d = 0\)</span>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[12]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Compute the eigenphase x from the eigenvalue of psi, where x is expressed in radians</span>
<span class="n">angle_rad</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">eigenvalue</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">angle_rad</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">%</span> <span class="mi">1</span>
<span class="n">target</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">num_ancilla_qubits</span> <span class="o">*</span> <span class="n">x</span>

<span class="c1"># Prepare measurement results (0, 1, ..., 2^n - 1)</span>
<span class="n">results</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">probs</span><span class="p">)))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">fr</span><span class="s2">&quot;The expected approximated result $2^</span><span class="si">{</span><span class="n">num_ancilla_qubits</span><span class="si">}</span><span class="s2">x = </span><span class="si">{</span><span class="n">target</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>
<span class="n">bin_labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">format</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;0</span><span class="si">{</span><span class="n">num_ancilla_qubits</span><span class="si">}</span><span class="s1">b&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">bin_labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Measurement outcome (binary)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Measurement Probability Distribution&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The probability distribution of outcomes in QPE and the corresponding expected approximated result&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code><br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The probability distribution of outcomes in QPE and the corresponding expected approximated result
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_AIAA-5072_week_8_qpe_26_1.png" src="../../_images/tutorials_AIAA-5072_week_8_qpe_26_1.png" />
</div>
</div>
<p>The horizontal axis represents the measurement outcomes, which corresponds to the binary representation of the phase, and the vertical axis represents the probability of each outcome. It can be observed that the outcome with the highest probability corresponds to the integer closest to <span class="math notranslate nohighlight">\(2^n x\)</span>.</p>
<h2 id="Extension">Extension<a class="headerlink" href="#Extension" title="Link to this heading">¶</a></h2>
<p>QPE also has variants and special cases, for example, it can sometimes be performed using only a single ancilla qubit without increasing circuit depth such as the iterative phase estimation algorithm (IPEA) based on the semiclassical quantum Fourier transform [6]. Here we discuss two special cases:</p>
<ul class="simple">
<li><p>The input state <span class="math notranslate nohighlight">\(| \psi\rangle\)</span> is no longer an eigenstate but a random state.</p></li>
<li><p>The unitary <span class="math notranslate nohighlight">\(U\)</span> is the Grover operator used in the quantum amplitude amplification (QAE) algorithm [7] in <code class="docutils literal notranslate"><span class="pre">week</span> <span class="pre">5</span> <span class="pre">qaa.ipynb</span></code>.</p></li>
</ul>
<h3 id="Random-input-state">Random input state<a class="headerlink" href="#Random-input-state" title="Link to this heading">¶</a></h3>
<p>In this special case, the problem can be defined as follows: given a unitary operator with the spectral decomposition <span class="math notranslate nohighlight">\(U = \sum_j e^{2\pi i x_j} | \psi_j\rangle\langle\psi_j|,\)</span> a random state <span class="math notranslate nohighlight">\(| \psi\rangle\)</span> is chosen, which can be expressed as a superposition of the eigenstates <span class="math notranslate nohighlight">\(| \psi\rangle = \sum_j c_j | \psi_j\rangle, c_j \in \mathbb{C}.\)</span> The goal is to use the QPE algorithm to estimate the eigenphases corresponding to multiple eigenstates.</p>
<p>To better illustrate the randomness, 20 random quantum states are generated here:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[13]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">batch_state</span> <span class="o">=</span> <span class="n">random_state</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">system_dim</span><span class="o">=</span><span class="n">dim_main</span><span class="p">)</span>
<span class="n">batch_input_state</span>  <span class="o">=</span> <span class="n">nkron</span><span class="p">(</span><span class="n">zero_state</span><span class="p">(</span><span class="n">num_ancilla_qubits</span><span class="p">),</span> <span class="n">batch_state</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<p>When <span class="math notranslate nohighlight">\(| \psi\rangle\)</span> is a random state, QPE still works because the above derivation is linear. However, the resulting probability distribution becomes more complex, and the probability of obtaining each <span class="math notranslate nohighlight">\(x_j\)</span> depends on the magnitude of <span class="math notranslate nohighlight">\(c_j\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[14]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">batch_measured_state</span> <span class="o">=</span> <span class="n">cir</span><span class="p">(</span><span class="n">batch_input_state</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_ancilla_qubits</span><span class="p">)))</span>
<span class="n">batch_probs</span> <span class="o">=</span> <span class="n">batch_measured_state</span><span class="o">.</span><span class="n">probability</span>
</code></pre></div>
</div>
</div>
<p>Prepare to plot the results to verify that the outputs match the theoretical expectations:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[15]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="c1"># Compute the phase angles of eigenvalues</span>
<span class="n">angle_rad</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">eigvals</span><span class="p">)</span>
<span class="n">x_js</span> <span class="o">=</span> <span class="p">(</span><span class="n">angle_rad</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">%</span> <span class="mi">1</span>

<span class="c1"># Number of possible measurement outcomes</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">num_ancilla_qubits</span>

<span class="c1"># Compute the average probability across a batch of measurements</span>
<span class="n">avg_probs</span> <span class="o">=</span> <span class="n">batch_probs</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">avg_probs</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">),</span> <span class="n">values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">fr</span><span class="s2">&quot;The expected approximated results $2^</span><span class="si">{</span><span class="n">num_ancilla_qubits</span><span class="si">}</span><span class="s2">x_j$&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_js</span><span class="p">:</span>
    <span class="n">target</span> <span class="o">=</span> <span class="n">N</span> <span class="o">*</span> <span class="n">x</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">bin_labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;0</span><span class="si">{</span><span class="n">num_ancilla_qubits</span><span class="si">}</span><span class="s1">b&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">//</span> <span class="mi">16</span><span class="p">)),</span> <span class="n">bin_labels</span><span class="p">[::</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">//</span> <span class="mi">16</span><span class="p">)],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Measurement outcomes (binary)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Average probability&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;QPE Average Probability Distribution&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The average probability distribution of outcomes in QPE and the corresponding expected approximated results&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The average probability distribution of outcomes in QPE and the corresponding expected approximated results
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_AIAA-5072_week_8_qpe_34_1.png" src="../../_images/tutorials_AIAA-5072_week_8_qpe_34_1.png" />
</div>
</div>
<p>From the plot, we can see that the outcomes with the highest probabilities correspond roughly to the binary estimates of the eigenphases.</p>
<h3 id="Quantum-amplitude-estimation-algorithm">Quantum amplitude estimation algorithm<a class="headerlink" href="#Quantum-amplitude-estimation-algorithm" title="Link to this heading">¶</a></h3>
<p>According to Oblivious Amplitude Amplification (<strong>OAA</strong>) [8] discussed in the tutorial of quantum amplitude amplification, we can formalize Quantum Amplitude Estimation (<strong>QAE</strong>) as: given a quantum algorithm or operator <span class="math notranslate nohighlight">\(A\)</span> acting on <span class="math notranslate nohighlight">\(|0\rangle|\psi\rangle\)</span>, it produces</p>
<div class="math notranslate nohighlight">
\[A |0\rangle|\psi\rangle = \sin(\theta) |0\rangle V |\psi\rangle + \cos(\theta) |\Psi^\perp\rangle,\tag{12}\]</div>
<p>where <span class="math notranslate nohighlight">\((\langle0| \otimes I) |\Psi^\perp\rangle = 0.\)</span> The goal is to estimate <span class="math notranslate nohighlight">\(|\sin(\theta)|\)</span>, which is the amplitude of the target state <span class="math notranslate nohighlight">\(|0\rangle V |\psi\rangle\)</span>. This amplitude corresponds to the probability of obtaining a “good” outcome when measuring the first register. QAE estimates this amplitude using techniques such as QPE without intermediate measurements, allowing more accurate approximate counting or success probability estimation than classical methods. The
Grover-like operator <span class="math notranslate nohighlight">\(Q = -A S_0 A^\dagger S_0\)</span> with <span class="math notranslate nohighlight">\(S_0 = (I - 2 |0\rangle\langle0|) \otimes I\)</span> is regarded as the unitary <span class="math notranslate nohighlight">\(U\)</span> that needs to be repeatedly applied in QPE. Here, we adopt an improved variant of the original QAE procedure [7].</p>
<p>First we randomly generate <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(|\psi\rangle\)</span>, compute <span class="math notranslate nohighlight">\(\theta\)</span>, and then construct <span class="math notranslate nohighlight">\(Q\)</span>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[16]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">num_ancilla_qubit</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_main_qubit</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">random_lcu</span><span class="p">(</span><span class="n">num_main_qubit</span><span class="p">,</span> <span class="n">num_ancilla_qubit</span><span class="p">)</span>
<span class="n">aux_zero</span> <span class="o">=</span> <span class="n">zero_state</span><span class="p">(</span><span class="n">num_ancilla_qubit</span><span class="p">)</span>
<span class="n">psi</span> <span class="o">=</span> <span class="n">random_state</span><span class="p">(</span><span class="n">num_main_qubit</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[17]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">dim_total</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">num_ancilla_qubit</span> <span class="o">+</span> <span class="n">num_main_qubit</span><span class="p">)</span>
<span class="n">dim_main</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">num_main_qubit</span>

<span class="c1"># Compute theta</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">nkron</span><span class="p">(</span><span class="n">aux_zero</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>
<span class="n">final_state</span> <span class="o">=</span> <span class="n">A</span> <span class="o">@</span> <span class="n">init_state</span><span class="o">.</span><span class="n">ket</span>
<span class="n">proj_0I</span> <span class="o">=</span> <span class="n">nkron</span><span class="p">(</span><span class="n">aux_zero</span><span class="o">.</span><span class="n">bra</span><span class="p">,</span> <span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="n">target_vec</span> <span class="o">=</span> <span class="n">proj_0I</span> <span class="o">@</span> <span class="n">final_state</span>             <span class="c1"># = (⟨0|⊗I) A|0&gt;|psi&gt;</span>
<span class="n">sin_theta</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">target_vec</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>  <span class="c1"># compute amplitude</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">sin_theta</span><span class="p">)</span>

<span class="c1"># Construct Grover-like operator Q</span>
<span class="n">S_0</span> <span class="o">=</span> <span class="n">eye</span><span class="p">(</span><span class="n">dim_total</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nkron</span><span class="p">(</span><span class="n">aux_zero</span><span class="o">.</span><span class="n">density_matrix</span><span class="p">,</span> <span class="n">eye</span><span class="p">(</span><span class="n">dim_main</span><span class="p">))</span>  <span class="c1"># reflection about |0&gt;</span>
<span class="n">Q</span> <span class="o">=</span> <span class="o">-</span><span class="n">A</span> <span class="o">@</span> <span class="n">S_0</span> <span class="o">@</span> <span class="n">dagger</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">@</span> <span class="n">S_0</span>                                   <span class="c1"># Grover-like operator</span>
</code><br/></pre></div>
</div>
</div>
<p>Next, we will show that when the input state is <span class="math notranslate nohighlight">\(A |0\rangle|\psi\rangle\)</span>, using the QPE algorithm with queries to the controlled-<span class="math notranslate nohighlight">\(Q\)</span> operator can output either <span class="math notranslate nohighlight">\(+2\theta\)</span> or <span class="math notranslate nohighlight">\(-2\theta\)</span>, where <span class="math notranslate nohighlight">\(|\sin(\theta)|\)</span> is the amplitude we want to estimate.</p>
<p>First, for simplicity, we introduce several notations: $|:nbsphinx-math:<cite>phi</cite>_0:nbsphinx-math:<cite>rangle `= |0:nbsphinx-math:</cite>rangle <cite>V |:nbsphinx-math:</cite>psi`:nbsphinx-math:<cite>rangle</cite>, |:nbsphinx-math:<cite>phi</cite>_1:nbsphinx-math:<cite>rangle `= |:nbsphinx-math:</cite>Psi`^:nbsphinx-math:<cite>perp</cite><span class="math">\rangle</span>. $</p>
<p>In the basis <span class="math notranslate nohighlight">\(\{ |\phi_0\rangle, |\phi_1\rangle \}\)</span>, the matrix representation of the operator <span class="math notranslate nohighlight">\(Q\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}Q =
\begin{pmatrix}
\cos(2\theta) &amp; \sin(2\theta) \\
-\sin(2\theta) &amp; \cos(2\theta)
\end{pmatrix}\end{split}\]</div>
<p>The detailed derivation can be found in the tutorial of quantum amplitude amplification. <span class="math notranslate nohighlight">\(Q\)</span> is a rotation matrix, whose characteristic equation is <span class="math notranslate nohighlight">\(\det(Q - \lambda I) = (\cos(2\theta) - \lambda)^2 + \sin^2(2\theta) = 0\)</span>, giving eigenvalues: <span class="math notranslate nohighlight">\(\lambda_{\pm} = \cos(2\theta) \pm i\sin(2\theta) = e^{\pm i 2\theta}\)</span>, with corresponding eigenvectors: <span class="math notranslate nohighlight">\(|w_{\pm}\rangle = \frac{1}{\sqrt{2}} \left( |\phi_0\rangle \pm i |\phi_1\rangle \right)\)</span></p>
<p>In the following, we verified <span class="math notranslate nohighlight">\(|w_{\pm}\rangle\)</span> are eigenvectors of <span class="math notranslate nohighlight">\(Q\)</span>, and the corresponding eigenphases are <span class="math notranslate nohighlight">\(\pm 2\theta\)</span> through experiment:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[18]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">phi0</span> <span class="o">=</span> <span class="n">proj_0I</span> <span class="o">@</span> <span class="n">final_state</span>
<span class="n">phi0</span> <span class="o">=</span> <span class="n">nkron</span><span class="p">(</span><span class="n">aux_zero</span><span class="o">.</span><span class="n">ket</span><span class="p">,</span> <span class="n">phi0</span><span class="p">)</span>
<span class="n">phi0_full</span> <span class="o">=</span> <span class="n">phi0</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">phi0</span><span class="p">)</span>

<span class="n">phi1_full</span> <span class="o">=</span> <span class="n">final_state</span> <span class="o">-</span> <span class="n">phi0</span>
<span class="n">phi1_full</span> <span class="o">=</span> <span class="n">phi1_full</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">phi1_full</span><span class="p">)</span>

<span class="n">w_plus</span>  <span class="o">=</span> <span class="p">(</span><span class="n">phi0_full</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phi1_full</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">w_minus</span> <span class="o">=</span> <span class="p">(</span><span class="n">phi0_full</span> <span class="o">-</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">phi1_full</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">eigenvalue_plus</span>  <span class="o">=</span> <span class="p">(</span><span class="n">dagger</span><span class="p">(</span><span class="n">w_plus</span><span class="p">)</span>  <span class="o">@</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">w_plus</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="n">eigenvalue_minus</span> <span class="o">=</span> <span class="p">(</span><span class="n">dagger</span><span class="p">(</span><span class="n">w_minus</span><span class="p">)</span> <span class="o">@</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">w_minus</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Eigenphases of Q with respect to |w±&gt;:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">eigenvalue_plus</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">eigenvalue_minus</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2θ =&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">theta</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Eigenphases of Q with respect to |w±&gt;: 1.2798670359876532 -1.2798670359876532
2θ = 1.2798670359876536
</pre></div></div>
</div>
<p>Then the input state can be decomposed as: <span class="math">\begin{align*}
A |0\rangle|\psi\rangle &= \sin(\theta)|\phi_0\rangle + \cos(\theta)|\phi_1\rangle\\
&= \frac{1}{\sqrt{2}} \left[ (\sin\theta - i \cos\theta) |w_+ + (\sin\theta + i \cos\theta) |w_-\rangle \right] \tag{13}
\end{align*}</span></p>
<p>The modulus squared of the coefficients: <span class="math notranslate nohighlight">\(\left| \frac{1}{\sqrt{2}} (\sin\theta - i \cos\theta) \right|^2 = \frac{1}{2}\)</span> ,<span class="math notranslate nohighlight">\(\left| \frac{1}{\sqrt{2}} (\sin\theta + i \cos\theta) \right|^2 = \frac{1}{2}.\)</span></p>
<p>Thus, the input state is a uniform superposition of the two eigenvectors of <span class="math notranslate nohighlight">\(Q\)</span>: <span class="math notranslate nohighlight">\(A|0\rangle |\psi\rangle = \frac{1}{\sqrt{2}} \left( e^{-i\eta} |w_+\rangle + e^{i\eta} |w_-\rangle \right), \eta = \arctan\left( \frac{\sin\theta}{\cos\theta} \right).\)</span></p>
<p>Next, we present the circuit implementation of QAE:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[19]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">cir</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="n">num_ancilla_qubits</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">system_dim</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_ancilla_qubits</span> <span class="o">+</span> <span class="n">init_state</span><span class="o">.</span><span class="n">system_dim</span><span class="p">)</span>

<span class="n">cir</span><span class="o">.</span><span class="n">oracle</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">cir</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_ancilla_qubits</span><span class="p">)))</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_ancilla_qubits</span><span class="p">):</span>
    <span class="n">cir</span><span class="o">.</span><span class="n">oracle</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">k</span><span class="p">),</span> <span class="p">[[</span><span class="n">num_ancilla_qubits</span> <span class="o">-</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">control_idx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Q^{</span><span class="si">%d</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">k</span><span class="p">))</span>

<span class="n">qft_inverse</span> <span class="o">=</span> <span class="n">dagger</span><span class="p">(</span><span class="n">qft_matrix</span><span class="p">(</span><span class="n">num_ancilla_qubits</span><span class="p">))</span>
<span class="n">cir</span><span class="o">.</span><span class="n">oracle</span><span class="p">(</span><span class="n">qft_inverse</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_ancilla_qubits</span><span class="p">)),</span> <span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;\operatorname</span><span class="si">{QFT}</span><span class="s1">_{</span><span class="si">%d</span><span class="s1">}^{-1}&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">num_ancilla_qubits</span><span class="p">))</span>
<span class="n">cir</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">num_ancilla_qubits</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Circuit for implementing QAE&quot;</span><span class="p">)</span>
<span class="n">cir</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</code><br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Circuit for implementing QAE
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_AIAA-5072_week_8_qpe_45_1.png" src="../../_images/tutorials_AIAA-5072_week_8_qpe_45_1.png" />
</div>
</div>
<p>Next, we present the measurement results and their probability distribution:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[20]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">input_state</span> <span class="o">=</span> <span class="n">nkron</span><span class="p">(</span><span class="n">kron_power</span><span class="p">(</span><span class="n">zero_state</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">num_ancilla_qubits</span><span class="p">),</span> <span class="n">init_state</span><span class="p">)</span>
<span class="n">output_state</span> <span class="o">=</span> <span class="n">cir</span><span class="p">(</span><span class="n">input_state</span><span class="p">)</span>

<span class="n">probs</span> <span class="o">=</span> <span class="n">output_state</span><span class="o">.</span><span class="n">probability</span>
</code></pre></div>
</div>
</div>
<p>In the post-processing, we compute <span class="math notranslate nohighlight">\(|\sin(\theta)|\)</span> for each QPE measurement result <span class="math notranslate nohighlight">\(k\)</span>, plot the probability distribution, and highlight the bar corresponding to the true value.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[21]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="n">angle_rad</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">eigvals</span><span class="p">)</span>

<span class="c1"># Convert the angles to fractional phases x_j in [0, 1)</span>
<span class="n">x_js</span> <span class="o">=</span> <span class="p">(</span><span class="n">angle_rad</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">%</span> <span class="mi">1</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">num_ancilla_qubits</span>

<span class="c1"># Compute θ_k and the corresponding |sin(θ_k)|</span>
<span class="n">k_vals</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">theta_k</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">k_vals</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span>
<span class="n">estimated_sin_theta</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta_k</span><span class="p">))</span>

<span class="n">probs_list</span> <span class="o">=</span> <span class="n">probs</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">rounded_amp</span> <span class="o">=</span> <span class="p">(</span><span class="n">estimated_sin_theta</span> <span class="o">*</span> <span class="mi">10000</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">()</span> <span class="o">/</span> <span class="mi">10000</span>
<span class="n">unique_amplitudes</span><span class="p">,</span> <span class="n">inverse_indices</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">rounded_amp</span><span class="p">,</span> <span class="n">return_inverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">combined_probs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">unique_amplitudes</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">inverse_indices</span><span class="p">,</span> <span class="n">probs_list</span><span class="p">):</span>
    <span class="n">combined_probs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">+=</span> <span class="n">p</span>

<span class="n">true_amplitude</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sin_theta</span><span class="p">)</span>
<span class="n">true_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">unique_amplitudes</span> <span class="o">-</span> <span class="n">true_amplitude</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">bars</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_amplitudes</span><span class="p">)),</span> <span class="n">combined_probs</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">bar</span><span class="p">,</span> <span class="n">amp</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bars</span><span class="p">,</span> <span class="n">unique_amplitudes</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">bar</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">bar</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.02</span><span class="p">,</span>
             <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">amp</span><span class="o">.</span><span class="n">item</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
             <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">true_idx</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;True amplitude = </span><span class="si">{</span><span class="n">true_amplitude</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Estimated $|\sin(\theta_k)|$ from QPE measurement&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Estimated amplitude&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The probability distribution of estimated amplitudes |sin(θ_k)| from QPE measurement and the corresponding true amplitude |sin(θ)|&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code><br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The probability distribution of estimated amplitudes |sin(θ_k)| from QPE measurement and the corresponding true amplitude |sin(θ)|
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/tutorials_AIAA-5072_week_8_qpe_49_1.png" src="../../_images/tutorials_AIAA-5072_week_8_qpe_49_1.png" />
</div>
</div>
<p>Then, we compare the true value with the estimated result:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[22]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">estimated_amplitude</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">((</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">true_idx</span><span class="p">)</span> <span class="o">/</span> <span class="n">N</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;True amplitude = </span><span class="si">{</span><span class="n">true_amplitude</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Estimated amplitude = </span><span class="si">{</span><span class="n">estimated_amplitude</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> with probability </span><span class="si">{</span><span class="n">combined_probs</span><span class="p">[</span><span class="n">true_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Absolute Error = </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="n">estimated_amplitude</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">true_amplitude</span><span class="p">)</span><span class="si">:</span><span class="s2">.6e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
True amplitude = 0.597142
Estimated amplitude = 0.555570 with probability 0.800694
Absolute Error = 4.157188e-02
</pre></div></div>
</div>
<hr class="docutils" />
<h2 id="References">References<a class="headerlink" href="#References" title="Link to this heading">¶</a></h2>
<p>[1] Kitaev, A. Yu. “Quantum measurements and the Abelian stabilizer problem.” arXiv preprint quant-ph/9511026 (1995).</p>
<p>[2] Shor, Peter W. “Polynomial-time algorithms for prime factorization and discrete logarithms on a quantum computer.” SIAM review 41.2 (1999): 303-332.</p>
<p>[3] Cleve, Richard, et al. “Quantum algorithms revisited.” Proceedings of the Royal Society of London. Series A: Mathematical, Physical and Engineering Sciences 454.1969 (1998): 339-354.</p>
<p>[4] Harrow, Aram W., Avinatan Hassidim, and Seth Lloyd. “Quantum algorithm for linear systems of equations.” Physical review letters 103.15 (2009): 150502.</p>
<p>[5] Aspuru-Guzik, Alán, et al. “Simulated quantum computation of molecular energies.” Science 309.5741 (2005): 1704-1707.</p>
<p>[6] Dobšíček, Miroslav, et al. “Arbitrary accuracy iterative quantum phase estimation algorithm using a single ancillary qubit: A two-qubit benchmark.” Physical Review A—Atomic, Molecular, and Optical Physics 76.3 (2007): 030306.</p>
<p>[7] Brassard, Gilles, et al. “Quantum amplitude amplification and estimation.” arXiv preprint quant-ph/0005055 (2000).</p>
<p>[8] Berry, Dominic W., et al. “Exponential improvement in precision for simulating sparse Hamiltonians.” Proceedings of the forty-sixth annual ACM symposium on Theory of computing. 2014.</p>
<p><em>Table: A reference of notation conventions in this tutorial.</em></p>
<table class="docutils data align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Symbol</p></th>
<th class="head"><p>Variant</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(U,V,A\)</span></p></td>
<td></td>
<td><p>Unitary operator</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(H\)</span></p></td>
<td></td>
<td><p>Hamiltonian</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\|\cdot\rangle\)</span></p></td>
<td></td>
<td><p>Quantum state</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\theta,\eta\)</span></p></td>
<td></td>
<td><p>Eigenphase (Unnormalized)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(x\)</span></p></td>
<td></td>
<td><p>Eigenphase (Normalized)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\| \Psi_0\rangle\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\| 0\rangle^{\otimes n} \| \psi\rangle\)</span></p></td>
<td><p>The input state of QPE</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\|j\rangle\)</span></p></td>
<td><p>$ <span class="math">\bigotimes</span><em>{:nbsphinx-math:`ell=0`}^{n-1} |j</em><span class="math">\ell</span>:nbsphinx-math:<a href="#id1"><span class="problematic" id="id2">`</span></a>rangle`$</p></td>
<td><p><span class="math notranslate nohighlight">\(j = \sum_{\ell=0}^{n-1} j_\ell 2^\ell\)</span> is the binary expansion of <span class="math notranslate nohighlight">\(j\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\| \Psi_1\rangle\)</span></p></td>
<td></td>
<td><p><span class="math notranslate nohighlight">\((H^{\otimes n} \otimes I) \|\Psi_0\rangle\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(CU\)</span></p></td>
<td></td>
<td><p><span class="math notranslate nohighlight">\(\sum_{k=0}^{2^n - 1} \|k\rangle \langle k\| \otimes U^k\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\| \Psi_2\rangle\)</span></p></td>
<td></td>
<td><p><span class="math notranslate nohighlight">\(CU \|\Psi_1\rangle\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\operatorname{QFT}^{-1}\)</span></p></td>
<td></td>
<td><p>The inverse of quantum Fourier transform</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\| \Psi_3\rangle\)</span></p></td>
<td></td>
<td><p><span class="math notranslate nohighlight">\((\operatorname{QFT}_{2^n}^{-1} \otimes I)\| \Psi_2\rangle\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\|0\rangle V \|\psi\rangle\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\|\phi_0\rangle\)</span></p></td>
<td><p>Good state in QAE</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\|\Psi^\perp\rangle\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\|\phi_1\rangle\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((\langle0\| \otimes I) \|\Psi^\perp\rangle = 0\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(S0\)</span></p></td>
<td><p>$(I - 2 |0:nbsphinx-math:<cite>rangle</cite><span class="math">\langle0</span>|) :nbsphinx-math:<a href="#id3"><span class="problematic" id="id4">`</span></a>otimes <a href="#id5"><span class="problematic" id="id6">`</span></a>I $</p></td>
<td><p>zero-state reflection operator</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(A^\dagger\)</span></p></td>
<td></td>
<td><p>The conjugate transpose of <span class="math notranslate nohighlight">\(A\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(Q\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-A S_0 A^\dagger S_0\)</span></p></td>
<td><p>Grover-like operator</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(det()\)</span></p></td>
<td></td>
<td><p>The determinant of a matrix</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\lambda\)</span></p></td>
<td></td>
<td><p>Eigenvalue</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(Pr(y)\)</span></p></td>
<td></td>
<td><p>The probability of obtaining result <span class="math notranslate nohighlight">\(y\)</span></p></td>
</tr>
</tbody>
</table>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span><code>[23]:
</code></pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><code><span class="n">qkit</span><span class="o">.</span><span class="n">print_info</span><span class="p">()</span>
</code></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

---------VERSION---------
quairkit: 0.4.2
torch: 2.8.0+cu128
torch cuda: 12.8
numpy: 2.2.6
scipy: 1.15.3
matplotlib: 3.10.6
---------SYSTEM---------
Python version: 3.10.18
OS: Linux
OS version: #1 SMP Tue Nov 5 00:21:55 UTC 2024
---------DEVICE---------
CPU:  13th Gen Intel(R) Core(TM) i9-13980HX
GPU: (0) NVIDIA GeForce RTX 4090 Laptop GPU
</pre></div></div>
</div>







  
  






                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  
  
  <div class="md-footer-meta md-typeset">
    
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-footer-copyright__highlight">
        &#169; Copyright 2024, QuAIR.
        
    </div>
  
    Created using
    <a href="https://www.sphinx-doc.org/" target="_blank" rel="noopener">Sphinx</a>
    8.1.3.
     and
    <a href="https://github.com/jbms/sphinx-immaterial/" target="_blank" rel="noopener">Sphinx-Immaterial</a>
  
</div>
      
    </div>
    
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike", "staticVersions": [{"aliases": ["v0.1.0"], "title": "v0.1.0", "version": "v0.1.0"}, {"aliases": ["v0.2.0"], "title": "v0.2.0", "version": "v0.2.0"}, {"aliases": ["v0.3.0"], "title": "v0.3.0", "version": "v0.3.0"}, {"aliases": ["v0.4.0"], "title": "v0.4.0", "version": "v0.4.0"}, {"aliases": ["v0.4.1"], "title": "v0.4.1", "version": "v0.4.1"}, {"aliases": ["v0.4.2"], "title": "v0.4.2", "version": "v0.4.2"}], "versionPath": null}}</script>
    
      
        <script src="../../_static/sphinx_immaterial_theme.32136f45f91ae6956.min.js?v=a7a9472a"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script id="MathJax-script" src="../../_static/mathjax/tex-mml-chtml.js?v=cadf963e"></script>
    
  </body>
</html>